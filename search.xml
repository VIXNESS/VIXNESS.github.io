<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Effective Modern C++ è¡Œä¸ºä¹ æƒ¯åˆ—ä¸¾</title>
    <url>/2019/05/07/Effective-Modern-C-%E8%A1%8C%E4%B8%BA%E4%B9%A0%E6%83%AF%E5%88%97%E4%B8%BE/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote>
<p>é¢å‘å·²ç»æŒæ¡äº†C++11ä¹‹å‰çš„åŒå­¦, æœ¬æ–‡åªåˆ—ä¸¾äº†åŸºæœ¬çš„å‡ æ¡.</p>
<p>ref: Effective Modern C++</p>
</blockquote><h2 id="ç”¨auto-ä»£æ›¿æ˜¾ç¤ºå£°æ˜"><a href="#ç”¨auto-ä»£æ›¿æ˜¾ç¤ºå£°æ˜" class="headerlink" title="ç”¨auto ä»£æ›¿æ˜¾ç¤ºå£°æ˜."></a>ç”¨<strong>auto</strong> ä»£æ›¿æ˜¾ç¤ºå£°æ˜.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typename</span> <span class="built_in">std</span>::iterator_traits&lt;It&gt;::value_type currValue = *b;</span><br></pre></td></tr></table></figure><a id="more"></a>


<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> currValue = *b;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨nullptr-æ›¿ä»£NULL-å’Œ0"><a href="#ä½¿ç”¨nullptr-æ›¿ä»£NULL-å’Œ0" class="headerlink" title="ä½¿ç”¨nullptr æ›¿ä»£NULL å’Œ0."></a>ä½¿ç”¨<strong>nullptr</strong> æ›¿ä»£<strong>NULL</strong> å’Œ<strong>0</strong>.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (result == <span class="number">0</span>)&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (result == <span class="literal">NULL</span>)&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (result == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨using-æ›¿ä»£typedef"><a href="#ä½¿ç”¨using-æ›¿ä»£typedef" class="headerlink" title="ä½¿ç”¨using æ›¿ä»£typedef."></a>ä½¿ç”¨<strong>using</strong> æ›¿ä»£<strong>typedef</strong>.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt; UPtrMapSS;</span><br></pre></td></tr></table></figure>
<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> UPtrMapSS = <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="built_in">std</span>::<span class="built_in">string</span>&gt;&gt;;</span><br></pre></td></tr></table></figure>
<h2 id="æœ‰èŒƒå›´çš„enum-æ›¿ä»£æ— èŒƒå›´çš„enum"><a href="#æœ‰èŒƒå›´çš„enum-æ›¿ä»£æ— èŒƒå›´çš„enum" class="headerlink" title="æœ‰èŒƒå›´çš„enum æ›¿ä»£æ— èŒƒå›´çš„enum."></a>æœ‰èŒƒå›´çš„<strong>enum</strong> æ›¿ä»£æ— èŒƒå›´çš„<strong>enum</strong>.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> Color &#123; black, white, red &#125;;</span><br><span class="line"><span class="keyword">auto</span> white = <span class="literal">false</span>; <span class="comment">//white å·²ç»è¢«å£°æ˜äº†, error!</span></span><br></pre></td></tr></table></figure>
<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="class"><span class="keyword">class</span> <span class="title">Color</span> &#123;</span> black, white, red &#125;;</span><br><span class="line"><span class="keyword">auto</span> white = <span class="literal">false</span>; <span class="comment">// ä¸€åˆ‡æ­£å¸¸</span></span><br><span class="line">Color c = Color::white; <span class="comment">//è§„èŒƒçš„å£°æ˜æ–¹å¼</span></span><br><span class="line"><span class="keyword">auto</span> c = Color::white; <span class="comment">//è§„èŒƒçš„å£°æ˜æ–¹å¼</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¦ç”¨å‡½æ•°æ—¶-ç”¨delete-æ›¿ä»£private"><a href="#ç¦ç”¨å‡½æ•°æ—¶-ç”¨delete-æ›¿ä»£private" class="headerlink" title="ç¦ç”¨å‡½æ•°æ—¶, ç”¨delete æ›¿ä»£private."></a>ç¦ç”¨å‡½æ•°æ—¶, ç”¨<strong>delete</strong> æ›¿ä»£<strong>private</strong>.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">basic_ios</span> :</span> <span class="keyword">public</span> ios_base &#123; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	...</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	basic_ios(<span class="keyword">const</span> basic_ios&amp; ); </span><br><span class="line">	basic_ios&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> basic_ios&amp;); </span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">basic_ios</span> :</span> <span class="keyword">public</span> ios_base &#123; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	basic_ios(<span class="keyword">const</span> basic_ios&amp; ) = <span class="keyword">delete</span>; </span><br><span class="line">	basic_ios&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> basic_ios&amp;) = <span class="keyword">delete</span>; </span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨override-å…³é”®å­—æ ‡æ³¨-overrideå‡½æ•°"><a href="#ä½¿ç”¨override-å…³é”®å­—æ ‡æ³¨-overrideå‡½æ•°" class="headerlink" title="ä½¿ç”¨override å…³é”®å­—æ ‡æ³¨ overrideå‡½æ•°."></a>ä½¿ç”¨<strong>override</strong> å…³é”®å­—æ ‡æ³¨ overrideå‡½æ•°.</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span> </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf1</span><span class="params">()</span> <span class="keyword">const</span></span>; </span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf2</span><span class="params">(<span class="keyword">int</span> x)</span></span>; </span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf3</span><span class="params">()</span> &amp;</span>; </span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">mf4</span><span class="params">()</span> <span class="keyword">const</span></span>; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span>:</span> <span class="keyword">public</span> Base &#123; </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf1</span><span class="params">()</span> override</span>; </span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf2</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> x)</span> override</span>; </span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf3</span><span class="params">()</span> &amp;&amp; override</span>; <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">mf4</span><span class="params">()</span> <span class="keyword">const</span> override</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨const-iterators-æ›¿ä»£iterators"><a href="#ä½¿ç”¨const-iterators-æ›¿ä»£iterators" class="headerlink" title="ä½¿ç”¨const_iterators æ›¿ä»£iterators."></a>ä½¿ç”¨const_iterators æ›¿ä»£iterators.</h2><p>âœ˜ é”™è¯¯ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; values;</span><br><span class="line">â€¦</span><br><span class="line"><span class="keyword">auto</span> it = <span class="built_in">std</span>::find(values.begin(),values.end(), <span class="number">1983</span>); <span class="comment">//ä½¿ç”¨begin()å’Œend()</span></span><br><span class="line">values.insert(it, <span class="number">1998</span>);</span><br></pre></td></tr></table></figure>
<p>âœ” æ­£ç¡®ç¤ºèŒƒ:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; values; </span><br><span class="line">â€¦</span><br><span class="line"><span class="keyword">auto</span> it = <span class="built_in">std</span>::find(values.cbegin(),values.cend(), <span class="number">1983</span>);<span class="comment">//ä½¿ç”¨cbegin()å’Œcend()</span></span><br><span class="line">values.insert(it, <span class="number">1998</span>);</span><br></pre></td></tr></table></figure>
<h2 id="å¦‚æœå‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸-ä½¿ç”¨noexceptè¿›è¡Œå£°æ˜"><a href="#å¦‚æœå‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸-ä½¿ç”¨noexceptè¿›è¡Œå£°æ˜" class="headerlink" title="å¦‚æœå‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸, ä½¿ç”¨noexceptè¿›è¡Œå£°æ˜."></a>å¦‚æœå‡½æ•°ä¸ä¼šæŠ›å‡ºå¼‚å¸¸, ä½¿ç”¨<strong>noexcept</strong>è¿›è¡Œå£°æ˜.</h2><p>âœ˜ C++98:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="title">throw</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>âœ” C++11:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="keyword">noexcept</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ-std-unique-ptr-std-shared-ptr-std-weak-ptræ›¿ä»£ä¼ ç»ŸæŒ‡é’ˆ-std-auto-æ·˜æ±°äº†åˆ«ç”¨äº†"><a href="#ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ-std-unique-ptr-std-shared-ptr-std-weak-ptræ›¿ä»£ä¼ ç»ŸæŒ‡é’ˆ-std-auto-æ·˜æ±°äº†åˆ«ç”¨äº†" class="headerlink" title="ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ std::unique_ptr, std::shared_ptr,  std::weak_ptræ›¿ä»£ä¼ ç»ŸæŒ‡é’ˆ (std::auto æ·˜æ±°äº†åˆ«ç”¨äº†)."></a>ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ <code>std::unique_ptr</code>, <code>std::shared_ptr</code>,  <code>std::weak_ptr</code>æ›¿ä»£ä¼ ç»ŸæŒ‡é’ˆ (<code>std::auto</code> æ·˜æ±°äº†åˆ«ç”¨äº†).</h2><h2 id="èƒ½ç”¨constexprå°±ç”¨constexpr"><a href="#èƒ½ç”¨constexprå°±ç”¨constexpr" class="headerlink" title="èƒ½ç”¨constexprå°±ç”¨constexpr."></a>èƒ½ç”¨constexprå°±ç”¨constexpr.</h2><h2 id="è®©å¸¸æˆå‘˜å‡½æ•°çº¿ç¨‹å®‰å…¨-ä½¿ç”¨std-mutex-æˆ–std-atomic-ç­‰"><a href="#è®©å¸¸æˆå‘˜å‡½æ•°çº¿ç¨‹å®‰å…¨-ä½¿ç”¨std-mutex-æˆ–std-atomic-ç­‰" class="headerlink" title="è®©å¸¸æˆå‘˜å‡½æ•°çº¿ç¨‹å®‰å…¨: ä½¿ç”¨std::mutex æˆ–std::atomic ç­‰."></a>è®©<em>å¸¸æˆå‘˜å‡½æ•°</em>çº¿ç¨‹å®‰å…¨: ä½¿ç”¨<code>std::mutex</code> æˆ–<code>std::atomic</code> ç­‰.</h2><h2 id="å–„ç”¨å³å€¼-Rvalue-è¯­ä¹‰è½¬ç§»-Move-Semantics-å®Œç¾è½¬å‘-Perfect-Forwarding"><a href="#å–„ç”¨å³å€¼-Rvalue-è¯­ä¹‰è½¬ç§»-Move-Semantics-å®Œç¾è½¬å‘-Perfect-Forwarding" class="headerlink" title="å–„ç”¨å³å€¼[Rvalue], è¯­ä¹‰è½¬ç§»[Move Semantics], å®Œç¾è½¬å‘[Perfect Forwarding]"></a>å–„ç”¨å³å€¼[<em>Rvalue</em>], è¯­ä¹‰è½¬ç§»[<em>Move Semantics</em>], å®Œç¾è½¬å‘[<em>Perfect Forwarding</em>]</h2><h2 id="å–„ç”¨Lambda-è¡¨è¾¾å¼"><a href="#å–„ç”¨Lambda-è¡¨è¾¾å¼" class="headerlink" title="å–„ç”¨Lambda è¡¨è¾¾å¼"></a>å–„ç”¨Lambda è¡¨è¾¾å¼</h2><h2 id="å–„ç”¨å¹¶å‘ç¼–ç¨‹API"><a href="#å–„ç”¨å¹¶å‘ç¼–ç¨‹API" class="headerlink" title="å–„ç”¨å¹¶å‘ç¼–ç¨‹API"></a>å–„ç”¨å¹¶å‘ç¼–ç¨‹API</h2><h2 id="å®¹å™¨ä¸­ä½¿ç”¨emplace-back-æ›¿ä»£push-back"><a href="#å®¹å™¨ä¸­ä½¿ç”¨emplace-back-æ›¿ä»£push-back" class="headerlink" title="å®¹å™¨ä¸­ä½¿ç”¨emplace_back(),  æ›¿ä»£push_back()"></a>å®¹å™¨ä¸­ä½¿ç”¨<code>emplace_back()</code>,  æ›¿ä»£<code>push_back()</code></h2>]]></content>
      <categories>
        <category>c++</category>
      </categories>
      <tags>
        <tag>c++</tag>
      </tags>
  </entry>
  <entry>
    <title>PM2.5 é¢„æµ‹</title>
    <url>/2018/12/24/PM2-5/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨Linear-Regression-å¯¹PM2-5è¿›è¡Œé¢„æµ‹"><a href="#ä½¿ç”¨Linear-Regression-å¯¹PM2-5è¿›è¡Œé¢„æµ‹" class="headerlink" title="ä½¿ç”¨Linear Regression å¯¹PM2.5è¿›è¡Œé¢„æµ‹"></a>ä½¿ç”¨Linear Regression å¯¹PM2.5è¿›è¡Œé¢„æµ‹</h1><h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><blockquote>
<p><a href="https://github.com/VIXNESS/machine-learning-course/blob/master/pm25_predict/train.csv" target="_blank" rel="noopener">training data</a></p>
<p><a href="https://github.com/VIXNESS/machine-learning-course/blob/master/pm25_predict/test.csv" target="_blank" rel="noopener">testing data: samples</a></p>
<p><a href="https://github.com/VIXNESS/machine-learning-course/blob/master/pm25_predict/ans.csv" target="_blank" rel="noopener">testing data: label</a></p>
<p>Training data å’Œ Public testing data çš„ç»„ç»‡å½¢å¼:</p>
<p>ä¸€å¤©ç”±18è¡Œç»„æˆ,ä¸€è¡Œä¸ºä¸€ä¸ªæŒ‡æ ‡,ä¸€å…±ç”±18ä¸ªæŒ‡æ ‡,ä»ç¬¬4åˆ—å¼€å§‹è®°å½•æ¯ä¸ªæŒ‡æ ‡ä¸€å¤©å†…24å°æ—¶çš„å˜åŒ–æ•°å€¼,æ¯ä¸ªæœˆè¿ç»­è®°å½•å‰20å¤©ä½œä¸ºtraining set,å10å¤©ä½œä¸ºtesting set,ä¸€å…±è®°å½•äº†240ä¸ªå°æ—¶</p>
</blockquote><a id="more"></a>
<table>
<thead>
<tr>
<th>æ—¥æœŸ</th>
<th>è§‚æµ‹ç«™</th>
<th>æŒ‡æ ‡</th>
<th>0æ—¶</th>
<th>â€¦</th>
<th>23æ—¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>day 1</td>
<td>xxx</td>
<td>PM2.5</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 1</td>
<td>xxx</td>
<td>PM10</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 1</td>
<td>xxx</td>
<td>SO2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 1</td>
<td>xxx</td>
<td>â€¦</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 2</td>
<td>xxx</td>
<td>PM2.5</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 2</td>
<td>xxx</td>
<td>PM10</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 2</td>
<td>xxx</td>
<td>SO2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>day 2</td>
<td>xxx</td>
<td>â€¦</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h2><h3 id="å¿…è¦ç±»åº“"><a href="#å¿…è¦ç±»åº“" class="headerlink" title="å¿…è¦ç±»åº“"></a>å¿…è¦ç±»åº“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<h3 id="è½½å…¥æ•°æ®"><a href="#è½½å…¥æ•°æ®" class="headerlink" title="è½½å…¥æ•°æ®"></a>è½½å…¥æ•°æ®</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    data.append([]) <span class="comment"># åˆå§‹åŒ–18åˆ—</span></span><br><span class="line">n_row = <span class="number">0</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'train.csv'</span>,<span class="string">'r'</span>,encoding = <span class="string">'big5'</span>) <span class="keyword">as</span> text: <span class="comment">#csvç¼–ç æ˜¯big5</span></span><br><span class="line">    row = csv.reader(text, delimiter = <span class="string">","</span>)</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> row:</span><br><span class="line">        <span class="keyword">if</span> n_row != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>,<span class="number">27</span>):</span><br><span class="line">                <span class="keyword">if</span> r[i] != <span class="string">"NR"</span>: <span class="comment">#NRä¸ºæœªé™é›¨,å¯¹å…¶è®¾ç½®ä¸ºé™é›¨é‡</span></span><br><span class="line">                    data[(n_row - <span class="number">1</span>) % <span class="number">18</span>].append(float(r[i]))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                	<span class="comment">#è®¾æ–½0é™é›¨ä¸ºä¸€ä¸ªæ¥è¿‘0çš„å°é‡,</span></span><br><span class="line">                    <span class="comment">#è‹¥è®¾ä¸º0,åç»­çš„æ¢¯åº¦è®¡ç®—ä¼šæœ‰é™¤0çš„é£é™©</span></span><br><span class="line">                    data[(n_row - <span class="number">1</span>) % <span class="number">18</span>].append(float(<span class="number">0.0001</span>))</span><br><span class="line">        n_row += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="é‡æ–°ç»„ç»‡æ•°æ®"><a href="#é‡æ–°ç»„ç»‡æ•°æ®" class="headerlink" title="é‡æ–°ç»„ç»‡æ•°æ®"></a>é‡æ–°ç»„ç»‡æ•°æ®</h3><blockquote>
<p>å°†ä¹‹å‰çš„æ•°æ®é‡æ–°ç»„ç»‡,å¯¹æ¯ä¸ªå°æ—¶è¿›è¡Œè¿ç»­æ‹¼æ¥</p>
</blockquote>
<table>
<thead>
<tr>
<th>Features</th>
<th>0æ—¶</th>
<th>â€¦</th>
<th>23æ—¶</th>
<th>0æ—¶(æ¬¡æ—¥)</th>
<th>â€¦</th>
<th>23æ—¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>PM2.5</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>â€¦</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>..</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>PM 10</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = [] <span class="comment"># æ ·æœ¬çŸ©é˜µ</span></span><br><span class="line">y = [] <span class="comment"># å®é™…çš„å€¼</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">12</span>): <span class="comment"># 12ä¸ªæœˆ</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">471</span>): </span><br><span class="line">    <span class="comment"># æ¯è¾“å…¥9ä¸ªå°æ—¶çš„æ•°å€¼,é¢„æµ‹ç¬¬10ä¸ªå°æ—¶çš„PM2.5å€¼,</span></span><br><span class="line">    <span class="comment"># è¿™æ ·è¿ç»­çš„ã€Œ10ä¸ªå°æ—¶ã€æ¯ä¸ªæœˆæœ‰471ä¸ª</span></span><br><span class="line">        x.append([]) <span class="comment">#</span></span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> range(<span class="number">18</span>): <span class="comment"># éå†18ä¸ªç‰¹å¾</span></span><br><span class="line">            <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">9</span>): <span class="comment"># éå†å‰9ä¸ªå°æ—¶</span></span><br><span class="line">                x[<span class="number">471</span> * i + j].append(data[w][<span class="number">480</span> * i + j + t])</span><br><span class="line">        <span class="comment"># å°†ç¬¬10ä¸ªå°æ—¶çš„å€¼ä½œä¸ºå®é™…çš„PM2.5çš„å€¼</span></span><br><span class="line">        y.append(data[<span class="number">9</span>][<span class="number">480</span> * i + j + <span class="number">9</span>])</span><br><span class="line">x = np.array(x)</span><br><span class="line">y = np.array(y)</span><br><span class="line"></span><br><span class="line"><span class="comment">#åœ¨ç¬¬ä¸€åˆ—æ·»ä¸Šä¸€æ¡å…¨ä¸º1çš„åˆ—ä½œä¸ºbias</span></span><br><span class="line">x = np.concatenate((np.ones((x.shape[<span class="number">0</span>],<span class="number">1</span>)),x),axis = <span class="number">1</span>) </span><br><span class="line">w = np.zeros(x.shape[<span class="number">1</span>]) <span class="comment">#weight</span></span><br></pre></td></tr></table></figure>
<h2 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h2><h3 id="å®šä¹‰loss-function"><a href="#å®šä¹‰loss-function" class="headerlink" title="å®šä¹‰loss function"></a>å®šä¹‰loss function</h3><blockquote>
<p>ä½¿ç”¨ error square<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lossFunction</span><span class="params">(target,weight,samples)</span>:</span></span><br><span class="line">    M = target - np.dot(weight,samples.T)</span><br><span class="line">    loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        loss += m**<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> loss</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="Gradient-Descent"><a href="#Gradient-Descent" class="headerlink" title="Gradient Descent"></a>Gradient Descent</h3><blockquote>
<p>ä½¿ç”¨Adagra å¯¹learning rateè¿›è¡Œæ§åˆ¶</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lr = <span class="number">8</span> <span class="comment">#learning rate è®¾ç½®</span></span><br><span class="line">pre_grad = np.ones(x.shape[<span class="number">1</span>])<span class="comment"># æ¯ä¸ªç‰¹å¾æœ‰ç‹¬ç«‹çš„learning rate</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">    temp_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> range(<span class="number">36</span>):</span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> range(<span class="number">156</span>):</span><br><span class="line">            L = np.dot(w,x[<span class="number">157</span> * m + s].T) - y[<span class="number">157</span> * m + s]</span><br><span class="line">            grad = np.dot(x[<span class="number">157</span> * m + s].T,L)*(<span class="number">2</span>)</span><br><span class="line">            pre_grad += grad**<span class="number">2</span></span><br><span class="line">            ada = np.sqrt(pre_grad)</span><br><span class="line">            w = w - lr * grad/ada</span><br><span class="line">        temp_loss += abs(np.dot(w,x[<span class="number">157</span> * m + <span class="number">156</span>].T) - y[<span class="number">157</span> * m + <span class="number">156</span>])</span><br><span class="line">    print(<span class="string">"%.2f"</span> % (r * <span class="number">100</span> / <span class="number">10000</span>),<span class="string">'% loss:'</span>,<span class="string">"%.4f"</span> % (temp_loss / <span class="number">36</span>))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä¿å­˜ weights<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">np.save(<span class="string">'model.npy'</span>,w)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><ul>
<li>åŠ è½½æµ‹è¯•ç‰¹å¾æ•°æ®é›†(ç•¥)</li>
<li>åŠ è½½label</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y = []</span><br><span class="line">rr = <span class="number">0</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'ans.csv'</span>,<span class="string">'r'</span>,encoding = <span class="string">'big5'</span>) <span class="keyword">as</span> ans:</span><br><span class="line">    row = csv.reader(ans,delimiter = <span class="string">','</span>)</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> row:</span><br><span class="line">        <span class="keyword">if</span> rr != <span class="number">0</span>:</span><br><span class="line">            y.append(float(r[<span class="number">1</span>]))</span><br><span class="line">        rr += <span class="number">1</span></span><br><span class="line">y = np.array(y)</span><br></pre></td></tr></table></figure>
<ul>
<li>åŠ è½½weights</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">w = np.load(<span class="string">'model.npy'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>æµ‹è¯•</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t = np.dot(x,w)</span><br><span class="line">L = t - y</span><br><span class="line">loss = []</span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">    loss.append(abs(l))</span><br><span class="line">    sum += abs(l)</span><br><span class="line">print(sum / len(L))</span><br><span class="line">plt.plot(y,color = <span class="string">"red"</span>,label = <span class="string">'target'</span>)</span><br><span class="line">plt.plot(t,color = <span class="string">"blue"</span>,label = <span class="string">'hypothesis'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'pm 2.5'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p><img src="/images/PM25/model_1.png" alt="ç»“è®º"></p>
<blockquote>
<p>PM2.5 è¯¯å·® <strong>14.427</strong><br><del>å‚æ•°å¤ªå¤šè¿‡æ‹Ÿåˆ</del>æ²¡æœ‰è®­ç»ƒå¥½,å¡åœ¨äº†æŸä¸ªåœ°æ–¹äº†,trainingæ—¶å€™çš„lossä¹Ÿå¾ˆé«˜</p>
</blockquote>
<h2 id="å†ä¼˜åŒ–"><a href="#å†ä¼˜åŒ–" class="headerlink" title="å†ä¼˜åŒ–"></a>å†ä¼˜åŒ–</h2><blockquote>
<p>åªå–18ä¸ªç‰¹å¾ä¸­çš„NMHCã€NO2ã€O3ã€PM10ã€PM2.5</p>
</blockquote>
<p><img src="/images/PM25/model_1.png" alt="model_2"></p>
<blockquote>
<p>PM2.5 è¯¯å·® <strong>8.987</strong><br>ä¸€ä¸ªä¸é”™çš„å¼€å¤´,ç»§ç»­ä¼˜åŒ–</p>
<p>åªè€ƒè™‘PM 10å’ŒPM 2.5</p>
</blockquote>
<p><img src="/images/PM25/model_3.png" alt="model_3"></p>
<blockquote>
<p>PM2.5 è¯¯å·® <strong>6.281</strong></p>
</blockquote>
<blockquote>
<p>è‹¥åœ¨åˆ å‡ç‰¹å¾å‘¢?<br>åªè€ƒè™‘ PM2.5 </p>
</blockquote>
<p><img src="/images/PM25/model_4.png" alt="model_4"></p>
<blockquote>
<p>PM2.5 è¯¯å·® <strong>5.406</strong><br>æˆ‘æœäº†,ä¹‹å‰åšçš„æ—¶å€™æ˜¯ä¼šunderfittingå¯¼è‡´è¯¯å·®åˆ°7.4çš„,è¿™å›å€’å¥½æ›´åŠ ä½äº†</p>
</blockquote>
<h1 id="ä½¿ç”¨DNN-å¯¹PM2-5è¿›è¡Œé¢„æµ‹"><a href="#ä½¿ç”¨DNN-å¯¹PM2-5è¿›è¡Œé¢„æµ‹" class="headerlink" title="ä½¿ç”¨DNN å¯¹PM2.5è¿›è¡Œé¢„æµ‹"></a>ä½¿ç”¨DNN å¯¹PM2.5è¿›è¡Œé¢„æµ‹</h1><blockquote>
<p>ä½¿ç”¨çš„æ˜¯tensorflow + keras<br>é¢„å¤‡å·¥ä½œç•¥</p>
</blockquote>
<h2 id="Feature-Scaling"><a href="#Feature-Scaling" class="headerlink" title="Feature Scaling"></a>Feature Scaling</h2><blockquote>
<p>ç”¨äº†ä¸¤ä¸ªä¸åŒçš„Feature Scalingçš„æ–¹æ³•,ç»“æœä¸Šçœ‹å·®åˆ«ä¸å¤§,Standardizationæ›´åŠ å¥½ä¸€ç‚¹</p>
</blockquote>
<h3 id="Standardization"><a href="#Standardization" class="headerlink" title="Standardization"></a>Standardization</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardization</span><span class="params">(dataMatrix)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> dataMatrix.shape[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> dataMatrix</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dataMatrix.shape[<span class="number">1</span>]):</span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            sum += _x[i]</span><br><span class="line">        mean = sum / dataMatrix.shape[<span class="number">0</span>]</span><br><span class="line">        SD = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            SD += (_x[i] - mean)**<span class="number">2</span></span><br><span class="line">        SD = np.sqrt(SD / dataMatrix.shape[<span class="number">0</span>])</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            _x[i] = (_x[i] - mean) / SD</span><br><span class="line">    <span class="keyword">return</span> dataMatrix</span><br></pre></td></tr></table></figure>
<h3 id="Mean-Normalization"><a href="#Mean-Normalization" class="headerlink" title="Mean Normalization"></a>Mean Normalization</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">meanNormalization</span><span class="params">(dataMatrix)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> dataMatrix.shape[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> dataMatrix</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dataMatrix.shape[<span class="number">1</span>]):</span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line">        max = <span class="number">0</span></span><br><span class="line">        min = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            sum += data[i]</span><br><span class="line">            <span class="keyword">if</span> data[i] &gt; max:</span><br><span class="line">                max = data[i]</span><br><span class="line">            <span class="keyword">if</span> data[i] &lt; min:</span><br><span class="line">                min = data[i]</span><br><span class="line">        mean = sum / dataMatrix.shape[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> (max - min) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">                data[i] = (data[i] - mean) / (max - min)</span><br><span class="line">    <span class="keyword">return</span> dataMatrix</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">trainX = standardization(trainX)</span><br><span class="line">testX = standardization(testX)</span><br><span class="line"><span class="comment"># trainX = meanNormalization(trainX)</span></span><br><span class="line"><span class="comment"># testX = meanNormalization(testX)</span></span><br></pre></td></tr></table></figure>
<h2 id="è®­ç»ƒ-1"><a href="#è®­ç»ƒ-1" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h2><blockquote>
<p>ä½¿ç”¨outputä¸º8çš„ä¸¤å±‚layer,æ¿€æ´»å‡½æ•°æ˜¯ReLU(Sigmoidæ•ˆæœæ›´åŠ å·®)</p>
</blockquote>
<h3 id="å»ºç«‹æ¨¡å‹"><a href="#å»ºç«‹æ¨¡å‹" class="headerlink" title="å»ºç«‹æ¨¡å‹"></a>å»ºç«‹æ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    keras.layers.Dense(<span class="number">8</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">8</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">1</span>)</span><br><span class="line">    ])</span><br><span class="line">model.compile(loss=<span class="string">"mse"</span>,</span><br><span class="line">        optimizer=tf.train.RMSPropOptimizer(<span class="number">0.001</span>),</span><br><span class="line">        metrics=[<span class="string">'mae'</span>, <span class="string">'mse'</span>])</span><br></pre></td></tr></table></figure>
<h3 id="è®­ç»ƒ-2"><a href="#è®­ç»ƒ-2" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h3><blockquote>
<p>è·‘100ä¸ªepochsåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆå˜åŒ–äº†<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">history = model.fit(trainX, </span><br><span class="line">                    trainY, </span><br><span class="line">                    batch_size = <span class="number">64</span>, </span><br><span class="line">                    epochs = <span class="number">100</span>, </span><br><span class="line">                    validation_split = <span class="number">0.2</span>, </span><br><span class="line">                    verbose=<span class="number">0</span>, </span><br><span class="line">                    callbacks=[PrintDot()])</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>è®­ç»ƒæ—¶å€™çš„loss<br><img src="/images/PM25/loss.png" alt="training_loss"></p>
</blockquote>
<h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><blockquote>
<p>lossæ˜¯<strong>7.47</strong></p>
</blockquote>
<p><img src="/images/PM25/dnn.png" alt="test"></p>
<h2 id="å†ä¼˜åŒ–-1"><a href="#å†ä¼˜åŒ–-1" class="headerlink" title="å†ä¼˜åŒ–"></a>å†ä¼˜åŒ–</h2><h3 id="ä¸ä½¿ç”¨Feature-Scaling"><a href="#ä¸ä½¿ç”¨Feature-Scaling" class="headerlink" title="ä¸ä½¿ç”¨Feature Scaling"></a>ä¸ä½¿ç”¨Feature Scaling</h3><blockquote>
<p>è®­ç»ƒæ—¶å€™çš„loss<br><img src="/images/PM25/non_fs.png" alt="nonFS"></p>
</blockquote>
<blockquote>
<p>æµ‹è¯•æ—¶lossæ˜¯<strong>5.170</strong><br><img src="/images/PM25/non_fs_rs.png" alt="noFSr"></p>
</blockquote>
<h3 id="å¢åŠ layers"><a href="#å¢åŠ layers" class="headerlink" title="å¢åŠ layers"></a>å¢åŠ layers</h3><blockquote>
<p>å¢åŠ å¤šä¸€å±‚layer<br>  è®­ç»ƒæ—¶loss</p>
</blockquote>
<p><img src="/images/PM25/3layers_loss.png" alt="3layers"></p>
<blockquote>
<p>æµ‹è¯•æ—¶loss <strong>7.5</strong></p>
</blockquote>
<blockquote>
<p>æ‰€ä»¥è¯´DNNæœ€ä¼˜èƒ½è¾¾åˆ°5.17, Linear Modelæœ€ä¼˜5.4<br>ä¸é”™ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰</p>
</blockquote>
<h1 id="Repo"><a href="#Repo" class="headerlink" title="Repo"></a>Repo</h1><p><a href="https://github.com/VIXNESS/machine-learning-course.git" target="_blank" rel="noopener">VIXNESS/machine-learning-course</a></p>
]]></content>
      <categories>
        <category>machine learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>linear regression</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2018/12/23/hello-world/</url>
    <content><![CDATA[<p>Hello World!</p>
<p>æˆ‘å›æ¥å•¦~â•â•â•â•<br>å¼€å§‹å†™ä½œ,æ›´æ–°blogå•¦ ğŸ‰ğŸ‰ğŸ‰ğŸ‰</p>
]]></content>
      <categories>
        <category>life</category>
      </categories>
      <tags>
        <tag>life</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹æ‰¹åˆ¤æ€§æ€ç»´çš„å‡ ç‚¹è§è§£</title>
    <url>/2020/04/20/%E5%87%A0%E7%82%B9%E6%89%B9%E5%88%A4%E6%80%A7%E6%80%9D%E7%BB%B4%E7%9A%84%E8%A7%81%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="å¯¹æ‰¹åˆ¤æ€§æ€ç»´çš„å‡ ç‚¹è§è§£"><a href="#å¯¹æ‰¹åˆ¤æ€§æ€ç»´çš„å‡ ç‚¹è§è§£" class="headerlink" title="å¯¹æ‰¹åˆ¤æ€§æ€ç»´çš„å‡ ç‚¹è§è§£"></a>å¯¹æ‰¹åˆ¤æ€§æ€ç»´çš„å‡ ç‚¹è§è§£</h1><h2 id="è®ºç‚¹çš„ç»“æ„"><a href="#è®ºç‚¹çš„ç»“æ„" class="headerlink" title="è®ºç‚¹çš„ç»“æ„"></a>è®ºç‚¹çš„ç»“æ„</h2><p>å¯¹äºæ¥è§¦åˆ°çš„å¤§éƒ¨åˆ†è®ºç‚¹/ç»“æ„/è§‚ç‚¹, éœ€è¦å¯¹å…¶å†…æ ¸è¿›è¡Œåˆ†æ.</p><p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹, ä¸€ä¸ª<strong>å®Œæ•´</strong>çš„è§‚ç‚¹æ˜¯ç”±</p><p><strong>è®ºé¢˜ â€”â€” è®ºæ®(åŸå› /ç†ç”±) â€”â€” ç»“è®º(ç»“æœ) â€”â€” ç«‹åœº(ä»·å€¼è§‚)</strong></p><p>ç»„æˆ.</p><p>ä¸€èˆ¬æƒ…å†µä¸‹, è®ºç‚¹å’Œè®ºæ®ä¼šæ˜¾å¼åœ°ç»™å‡º. è€Œè®ºé¢˜å’Œç«‹åœºå¯èƒ½éœ€è¦è¿›è¡Œæ¨æ–­.</p><a id="more"></a>




<p>å•ç‹¬ç»™å‡ºè®ºé¢˜çš„æ—¶å€™, æŠ›å‡ºçš„æ˜¯ä¸€ä¸ªå¼€æ”¾æ€§çš„è®¨è®º, åªéœ€è¦åŒ…å®¹åœ°å»è®¨è®º.</p>
<h2 id="ä»ç»“è®ºå¼€å§‹åˆ‡å…¥"><a href="#ä»ç»“è®ºå¼€å§‹åˆ‡å…¥" class="headerlink" title="ä»ç»“è®ºå¼€å§‹åˆ‡å…¥"></a>ä»ç»“è®ºå¼€å§‹åˆ‡å…¥</h2><p>ç»“è®ºå’Œè®ºæ®å‡ºç°çš„å…ˆåé¡ºåºå¹¶ä¸æ˜¯å›ºå®šçš„, æˆ‘ä»¬å¿…é¡»ç¬¬ä¸€æ—¶é—´æŠ“ä½å…¶ç»“è®º, ç„¶åå¯¹ç»“è®ºå’Œè®ºæ®çš„å…³ç³»ä½œå‡ºåˆ†æ.</p>
<h3 id="ç¡®ç«‹å¯¹æ–¹çš„ç»“è®ºå’Œè®ºæ®"><a href="#ç¡®ç«‹å¯¹æ–¹çš„ç»“è®ºå’Œè®ºæ®" class="headerlink" title="ç¡®ç«‹å¯¹æ–¹çš„ç»“è®ºå’Œè®ºæ®"></a>ç¡®ç«‹å¯¹æ–¹çš„ç»“è®ºå’Œè®ºæ®</h3><p>æœ‰çš„æ—¶å€™, å¯¹æ–¹ä¼šå…ˆé™ˆè¿°ç†ç”±, å†æŠ›å‡ºä¸€ä¸ªç»“è®º, æˆ–è€…åä¹‹.</p>
<ul>
<li>å¯¹äºå…ˆè®²å‡ºç†ç”±, å†æŠ›å‡ºç»“è®ºçš„æƒ…å†µ, æˆ‘ä»¬å¯ä»¥åœ¨ä»–é™ˆè¿°å®Œè§‚ç‚¹åå¯¹å…¶è¿›è¡Œç¡®è®¤æ€§æé—®:</li>
</ul>
<blockquote>
<p> â€œä½ ä¹‹æ‰€ä»¥å¾—å‡ºè¿™ä¸ªç»“è®º, æ˜¯å› ä¸ºä½ è§‰å¾—æ˜¯â€¦.å¯¼è‡´çš„â€</p>
</blockquote>
<p>æå‡ºç±»ä¼¼ä»¥ä¸Šçš„é—®é¢˜ä»¥ç¡®è®¤å¯¹æ–¹çš„è®ºç‚¹å’Œè®ºæ®.</p>
<ul>
<li>æ˜ç¡®é™ˆè¿°ä¸­å®šä¹‰</li>
</ul>
<p>æœ‰æ—¶äººä»¬é™ˆè¿°çš„ä¸€äº›è¯æ˜¯å…³é”®ä¸”æ¨¡ç³Šã€å®šä¹‰ä¸æ˜ç¡®çš„, æˆ–è€…æ˜¯å¾ˆä¸»è§‚çš„. </p>
<p>æˆ‘ä»¬éœ€è¦å’Œå¯¹æ–¹è¿›è¡Œä¸€äº›å…³é”®å®šä¹‰çš„ç¡®è®¤. </p>
<p>å¦‚æœæ˜¯ä¸»è§‚çš„æ„Ÿå—, æˆ‘ä»¬å¯ä»¥ç¡®å®šä¸€ä¸ªåŒæ–¹è®¤å¯çš„èŒƒå›´.</p>
<blockquote>
<ul>
<li>â€œé£Ÿå ‚çš„é¥­èœéå¸¸éš¾åƒ, è¿™æ˜¯å¯¹å­¦ç”Ÿçš„ä¸è´Ÿè´£ä»»â€</li>
</ul>
<p>ä½ æ‰€è®¤ä¸ºçš„è´Ÿè´£æ˜¯æ€æ ·çš„? â€”â€” æ˜ç¡®ä»–æ‰€è®¤ä¸ºçš„ã€Œè´£ä»»ã€å®šä¹‰.</p>
<ul>
<li>â€œè¿™ä¸ªæ°´æœèƒ½ä½¿å¾—å¿ƒæƒ…å˜å¥½â€</li>
</ul>
<p>ä½ è§‰å¾—çš„å¥½å¿ƒæƒ…æ˜¯æŒ‡?</p>
</blockquote>
<h3 id="ç¡®ç«‹å¯¹æ–¹ä»·å€¼è§‚-ç«‹åœº-ç›®çš„"><a href="#ç¡®ç«‹å¯¹æ–¹ä»·å€¼è§‚-ç«‹åœº-ç›®çš„" class="headerlink" title="ç¡®ç«‹å¯¹æ–¹ä»·å€¼è§‚/ç«‹åœº/ç›®çš„"></a>ç¡®ç«‹å¯¹æ–¹ä»·å€¼è§‚/ç«‹åœº/ç›®çš„</h3><p>äº§ç”Ÿäº‰è®ºçš„ä¸€å¤§é‡è¦å› ç´ æ˜¯ä»·å€¼è§‚çš„ä¸åŒå¯¼è‡´çš„å†²çª.</p>
<p>å½“ä¸€ä¸ªäººæå‡ºä»–çš„è§‚ç‚¹, æˆ‘ä»¬éœ€è¦æ¨æ–­ä»–çš„ã€Œä»·å€¼è§‚ã€ã€ã€Œç«‹åœºã€å’Œã€Œç›®çš„ã€.</p>
<p>æ€è€ƒæ˜¯æ€æ ·çš„ç«‹åœºå’Œç›®çš„å¯¼è‡´ä»–å¾—å‡ºçš„ç»“è®º.</p>
<p>è‹¥å‘ç°æ˜¯ä»·å€¼è§‚çš„å†²çª, æˆ‘ä»¬ä¼šæ±‚åŒå­˜å¼‚, è€Œä¸æ˜¯è¿›è¡Œæ¿€çƒˆçš„äº‰æ‰§.</p>
<p>æ”¹å˜ä»–äººä»·å€¼è§‚æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹æƒ…, æˆ‘ä»¬æ— éœ€å¯¹ä»–äººä»·å€¼è§‚è¿›è¡Œå¼ºè¡Œæ‰­è½¬.</p>
<h3 id="æŒ£è„±äºŒå…ƒæ€§ç»“è®ºçš„æ·é”"><a href="#æŒ£è„±äºŒå…ƒæ€§ç»“è®ºçš„æ·é”" class="headerlink" title="æŒ£è„±äºŒå…ƒæ€§ç»“è®ºçš„æ·é”"></a>æŒ£è„±äºŒå…ƒæ€§ç»“è®ºçš„æ·é”</h3><p><strong>ç»“è®ºçš„æˆç«‹æ˜¯æ¡ä»¶æ€§çš„:</strong></p>
<p>äººä»¬å¾€å¾€å–œæ¬¢æå‡ºã€Œæ˜¯ä¸éã€çš„ç»“è®º â€”â€” ä¸æ˜¯è¿™æ ·, å°±æ˜¯é‚£æ ·.</p>
<p>æˆ‘ä»¬çš„ç¬¬ä¸€ååº”, ä¸è¯¥æ˜¯ã€Œæ˜¯ã€æˆ–ã€Œéã€è€Œæ˜¯å¯¹ç»“è®ºè¿›è¡Œã€Œç›®çš„ã€ã€ã€Œæ—¶é—´ã€ã€ã€Œç¯å¢ƒã€ç­‰å› ç´ çš„é™å®š:</p>
<ul>
<li>æŸäº›æ—¶å€™ç»“è®ºæˆç«‹ä¸å¦.</li>
<li>æŸäº›æ—¶é—´æˆç«‹ä¸å¦.</li>
<li>å‡ºäºæŸæŸç›®çš„æ˜¯æˆç«‹çš„, å‡ºäºå…¶ä»–ç›®çš„æ˜¯ä¸æˆç«‹çš„.</li>
<li>è®¨è®ºåˆ©å¼Š</li>
</ul>
<p><strong>å¯¹é—®é¢˜çš„ç»“è®ºè¿›è¡Œæ‰©å……:</strong></p>
<ul>
<li>è®¸å¤šé—®é¢˜å¹¶ä¸æ˜¯éé»‘å³ç™½çš„(æŠ˜è¡·æ€§).</li>
<li>æ˜¯å¦æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆ(å¤šé¢æ€§) â€”â€” è§£å†³æ–¹æ¡ˆæ˜¯å…±å­˜çš„, å¹¶ä¸æ˜¯å”¯ä¸€çš„.</li>
</ul>
<h3 id="ä»åŸå› -ç«‹åœº-ç›®çš„æ¨å‡ºå…¶ä»–ç»“è®º"><a href="#ä»åŸå› -ç«‹åœº-ç›®çš„æ¨å‡ºå…¶ä»–ç»“è®º" class="headerlink" title="ä»åŸå› /ç«‹åœº/ç›®çš„æ¨å‡ºå…¶ä»–ç»“è®º"></a>ä»åŸå› /ç«‹åœº/ç›®çš„æ¨å‡ºå…¶ä»–ç»“è®º</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†ææ”¯æ’‘ç»“è®ºçš„è®ºæ®, æ¨å¯¼å‡ºåœ¨ç‰¹å®šã€Œç›®çš„ã€ã€ã€Œæ—¶é—´ã€ã€ã€Œç¯å¢ƒã€ä¸‹çš„å…¶ä»–ç»“è®º.  </p>
<blockquote>
<p>â€œæˆ‘ä»¬åº”è¯¥å…³åœæ‰€æœ‰çš„ç½‘å§, å› ä¸ºç½‘å§ä½¿å¾—é’å°‘å¹´æ²‰è¿·ç½‘ç»œ.â€</p>
<p>ç»“è®º: æˆ‘ä»¬åº”è¯¥å…³åœç½‘å§.</p>
<p>è®ºæ®: ç½‘å§ä¼šä½¿å¾—é’å°‘å¹´æ²‰è¿·ç½‘ç»œ.</p>
<p>æ ¹æ®ç›®çš„æ‰©å……: ç›®çš„æ˜¯ä¸ºäº†è§£å†³é’å°‘å¹´æ²‰è¿·ç½‘ç»œ â€”â€” é™åˆ¶é’å°‘å¹´çš„è¿›å…¥, ä½¿ç”¨æ—¶é•¿ä»¥åŠå¼•å¯¼é’å°‘å¹´. </p>
</blockquote>
<p><strong>è¿›ä¸€æ­¥æ‰©å……è®¨è®ºèŒƒå›´.</strong></p>
<p>æ˜ç¡®ã€Œè®ºé¢˜ã€, ä»è®ºé¢˜ç€æ‰‹, çœ‹çœ‹æ˜¯å¦æœ‰å…¶ä»–çš„ã€Œè§£å†³ã€æ–¹æ³•.</p>
<p>ä»ã€Œè®ºé¢˜ã€çš„è§’åº¦å‡ºå‘, å°†é’ˆé”‹ç›¸å¯¹çš„äº‰è®ºåŒ–ä¸ºåŒ…å®¹çš„å¼€æ”¾æ€§è®¨è®º.</p>
<p>è®¨è®ºçš„æ ¸å¿ƒæ˜¯<strong>è§£å†³é—®é¢˜</strong>, è€Œä¸æ˜¯ã€Œäº‰è®ºã€.</p>
<hr>
<h3 id="åˆ†æè®ºæ®å’Œç»“è®ºçš„å…³ç³»"><a href="#åˆ†æè®ºæ®å’Œç»“è®ºçš„å…³ç³»" class="headerlink" title="åˆ†æè®ºæ®å’Œç»“è®ºçš„å…³ç³»"></a>åˆ†æè®ºæ®å’Œç»“è®ºçš„å…³ç³»</h3><p>å®Œæˆç¡®ç«‹ç»“è®ºå’Œè®ºæ®çš„æ­¥éª¤ä¹‹å, æˆ‘ä»¬å¯¹è®ºæ®å’Œç»“è®ºè¿›è¡Œå…³ç³»åˆ†æ.</p>
<ol>
<li><p>ç›¸å…³æ€§æ£€æŸ¥: è¿™ä¸ªè¿™ä¸ªè®ºæ®å’Œç»“è®ºç›¸å…³å—? </p>
<ul>
<li><p>äººä»¬æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯, å°†ä¸¤ä¸ªæ— å…³çš„ä¸œè¥¿ç»‘å®šåœ¨ä¸€èµ·.</p>
</li>
<li><p>äººä»¬å¾ˆå®¹æ˜“çŠ¯è¿™ç§é”™è¯¯, åº”é¦–å…ˆå¯¹å…¶è¿›è¡Œæ£€æŸ¥.</p>
</li>
</ul>
</li>
<li><p>å› æœæ€§æ£€æŸ¥: è®ºæ®å’Œç»“è®ºæ˜¯å› æœå…³ç³»ä¹ˆ? æ˜¯ä¸æ˜¯å…¶ä»–åŸå› å¯¼è‡´çš„? æ˜¯ä¸æ˜¯å’Œå…¶ä»–åŸå› å…±åŒä½œç”¨å¯¼è‡´çš„? </p>
<ol>
<li>å¯ä»¥ä½¿ç”¨åŸå› æ›¿æ¢çš„æ–¹æ³•, æ€è€ƒå…¶é™ˆè¿°çš„åŸå› æ˜¯å¦æ˜¯å…¶ç»“è®ºçš„ç›´æ¥/ä¸»è¦/å†³å®šæ€§çš„.</li>
<li>æƒ³æƒ³æ˜¯å¦ä¼šæ˜¯å…¶ä»–åŸå› å¯¼è‡´çš„ç»“æœ, æˆ–å…¶é™ˆè¿°çš„åŸå› å¹¶éæ˜¯ä¸å…¶ç»“è®ºæœ‰å› æœå…³ç³».</li>
</ol>
</li>
</ol>
<hr>
<h2 id="å¸¸è§çš„è°¬è¯¯"><a href="#å¸¸è§çš„è°¬è¯¯" class="headerlink" title="å¸¸è§çš„è°¬è¯¯"></a>å¸¸è§çš„è°¬è¯¯</h2><ul>
<li>æ°‘è°ƒ, å¤§ä¼—è§‚ç‚¹ä¾¿æ˜¯æ­£ç¡®çš„ â€”â€” çœŸç†æ—¢ä¸åœ¨å¤šæ•°äººæ‰‹é‡Œ, ä¹Ÿä¸åœ¨å°‘æ•°äººæ‰‹é‡Œ, çœŸç†æ˜¯å®¢è§‚å­˜åœ¨, ä¸äººæ— å…³.</li>
<li>åªæœ‰å®Œç¾è§£å†³æŸä¸ªé—®é¢˜çš„æ–¹æ³•æ‰èƒ½è¢«æ¥å—, å¦åˆ™å°±å…¨ç›˜å¦å®šå®ƒ.</li>
<li>æ‰£å¸½å­ â€”â€” å› ä¸ºä»–åšäº†Aè¿™ä»¶äº‹, æ‰€ä»¥ä»–å°±æ˜¯é‚£ç±»äºº.</li>
<li>æ¨å¯¼è”“å»¶ â€”â€” å› ä¸ºä»–åšäº†Aè¿™ä»¶äº‹, æ‰€ä»¥ä»–ä¹Ÿä¼šåšBè¿™ä»¶äº‹. (ç¦æ­¢ä½œä¸ºæœ‰æ•ˆè®ºæ®)</li>
</ul>
<hr>
<h2 id="è°¨é˜²çœŸå‡å‚åŠçš„è®ºè¯"><a href="#è°¨é˜²çœŸå‡å‚åŠçš„è®ºè¯" class="headerlink" title="è°¨é˜²çœŸå‡å‚åŠçš„è®ºè¯"></a>è°¨é˜²çœŸå‡å‚åŠçš„è®ºè¯</h2><blockquote>
<p>åå¥è¯, ä¹å¥æ˜¯çœŸçš„, ä¸€å¥æ˜¯å‡çš„.</p>
</blockquote>
<ul>
<li>æ¥æºç¡®è®¤.</li>
<li>ç»Ÿè®¡å­¦ç¡®è®¤.</li>
<li>ä¸“å®¶èº«ä»½ç¡®è®¤.</li>
</ul>
<p>å¤§æ–¹å‘: æ— å……åˆ†è¯æ®è¡¨æ˜, åˆ™ä¸ç›¸ä¿¡å…¶è®ºç‚¹.</p>
<hr>
<h2 id="æ‰¹åˆ¤æ€ç»´å¯¹è‡ªæˆ‘çš„æ‰¹åˆ¤"><a href="#æ‰¹åˆ¤æ€ç»´å¯¹è‡ªæˆ‘çš„æ‰¹åˆ¤" class="headerlink" title="æ‰¹åˆ¤æ€ç»´å¯¹è‡ªæˆ‘çš„æ‰¹åˆ¤"></a>æ‰¹åˆ¤æ€ç»´å¯¹è‡ªæˆ‘çš„æ‰¹åˆ¤</h2><ul>
<li>æ…¢æ€è€ƒ: æ€è€ƒå¤šä¸ªå¯èƒ½å­˜åœ¨çš„ç»“è®º, è€Œä¸æ˜¯æ€¥äºè¯æ˜è‡ªå·±æƒ³åˆ°çš„ç¬¬ä¸€ä¸ªè§‚ç‚¹.</li>
<li>å°½å¯èƒ½çš„è¶…è¶Šè‡ªå·±çš„ç«‹åœºå’Œä»·å€¼è§‚, æ€è€ƒåå¯¹è€…ç­‰å…¶ä»–æ–¹é¢çš„è§‚ç‚¹åŠå…¶ç†ç”±.</li>
<li>æ£€æŸ¥è‡ªå·±æ‰€ç”¨çš„å®šä¹‰æ˜¯å¦ç²¾å‡†, æ˜ç¡®è‡ªå·±çš„ç›®çš„, é€šè¿‡ç›®çš„æ¨æ¼”å¤šä¸ªå€™é€‰ç»“è®º.</li>
<li>é€šè¿‡ç»“è®ºæ£€æŸ¥è‡ªå·±çš„è®ºæ®/åŸå› , æ˜¯å¦æ˜¯å”¯ä¸€å†³å®šç»“è®ºçš„: <ul>
<li>å¾ˆå¤šæ—¶å€™ä½ çš„å› ç´ ä¸æ˜¯å†³å®šæ€§çš„, è€Œæ˜¯å¯¼è‡´ç»“è®ºçš„å› ç´ ã€Œä¹‹ä¸€ã€.</li>
<li>å¯èƒ½æ ¹æœ¬å°±ä¸æ˜¯åŸå› ä¹‹ä¸€.</li>
</ul>
</li>
<li>ç»“è®ºå¾ˆå¯èƒ½æ˜¯éäºŒå…ƒçš„:<ul>
<li>æŠ˜è¡·çš„ â€”â€” å¹¶ä¸æ˜¯éé»‘å³ç™½çš„.</li>
<li>å¤šé¢çš„ â€”â€” ç»“è®ºå…·æœ‰å¤šé¢æ€§, ç»“è®ºã€Œä¸å”¯ä¸€ã€, æ›´å¯èƒ½æ˜¯å¤šç»“è®ºå…±å­˜çš„.</li>
</ul>
</li>
<li>æ…ç”¨ç±»æ¯”, ç±»æ¯”ä¼šå«æ½œåœ¨æ¡ä»¶, ä¸åŸæœ¬çš„æ¡ä»¶ä¸ä¸€è‡´.</li>
<li>è°¨æ…çš„ç›®æ ‡æ€§è®ºè¯: ã€Œå…ˆå®šä¹‰ä¸€ä¸ªç›®æ ‡, å†é€šè¿‡å„ç§è¯æ®å»æ”¯æ’‘å®ƒã€, è¿™æ ·åšä¼šå› ä¸ºå…¶ç›®çš„æ€§å¯¼è‡´è®ºè¯çš„ç‰‡é¢, éœ€è¦æ…é‡, å¤šæ€è€ƒ<em>å¤šé¢æ€§</em>å’Œ<em>åé¢æ€§</em>.</li>
<li>ç¦æ­¢è”“å»¶å¼çš„æ¨å¯¼: å› ä¸ºäº‹ä»¶Açš„å‘ç”Ÿ, äº‹ä»¶Bä¹Ÿä¼šå‘ç”Ÿ, äº‹ä»¶Cä¹Ÿä¼šå‘ç”Ÿ. (å¯ä»¥è€ƒè™‘å¯èƒ½æ€§, ç¦æ­¢ä½œä¸ºè®ºæ®).</li>
<li>æ•¢äºè¯´å‡ºã€Œä¸çŸ¥é“ã€: <ul>
<li>å¯¹ä¸€ä¸ªäº‹ç‰©çš„ä¸äº†è§£, å¹¶ä¸ä¸€å®šä¸ªäººèƒ½åŠ›çš„é—®é¢˜.</li>
<li>è€Œå¾€å¾€æ˜¯å½“å‰æ— æ³•è·å¾—å……åˆ†çš„è¯æ®æ¥æ”¯æ’‘ä»»ä½•è®ºç‚¹. </li>
<li>ä¸å¦„ä¸‹æ–­è¨€æ˜¯è°¨æ…çš„è¡¨ç°.</li>
</ul>
</li>
<li>æ‰¹åˆ¤æ€§æ€ç»´å¹¶ä¸æ˜¯ä¸ºäº†å’Œåˆ«äººé’ˆé”‹ç›¸å¯¹, æ°æ°ç›¸å, è¦æŠ±ç€å­¦ä¹ å’Œäº¤æµçš„å¿ƒæ€è¿›è¡Œäº¤æµ.</li>
</ul>
]]></content>
      <categories>
        <category>others</category>
      </categories>
      <tags>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>DNN å¹´æ”¶å…¥é¢„æµ‹</title>
    <url>/2018/12/24/%E5%B9%B4%E6%94%B6%E5%85%A5%E9%A2%84%E6%B5%8B/</url>
    <content><![CDATA[<h1 id="æ”¶å…¥é¢„æµ‹"><a href="#æ”¶å…¥é¢„æµ‹" class="headerlink" title="æ”¶å…¥é¢„æµ‹"></a>æ”¶å…¥é¢„æµ‹</h1><blockquote>
<p>é€šè¿‡ èŒä½ã€å©šå§»æƒ…å†µã€å­¦å†ã€å®¶åº­è§’è‰²ã€ç§æ—ã€æ€§åˆ«å¯¹å…¶è¿›è¡Œå¹´è–ªçš„é¢„æµ‹ğŸ¥³ğŸ¥³</p>
</blockquote><h2 id="Data-Set"><a href="#Data-Set" class="headerlink" title="Data Set"></a>Data Set</h2><p><a href="https://github.com/VIXNESS/machine-learning-course/blob/master/winner/train.csv" target="_blank" rel="noopener">Training Data</a></p><p><a href="https://github.com/VIXNESS/machine-learning-course/blob/master/winner/test.csv" target="_blank" rel="noopener">Testing Data</a></p><h2 id="é¢„å¤‡å·¥ä½œ"><a href="#é¢„å¤‡å·¥ä½œ" class="headerlink" title="é¢„å¤‡å·¥ä½œ"></a>é¢„å¤‡å·¥ä½œ</h2><h3 id="æ‰€éœ€ç±»åº“"><a href="#æ‰€éœ€ç±»åº“" class="headerlink" title="æ‰€éœ€ç±»åº“"></a>æ‰€éœ€ç±»åº“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> csv</span><br></pre></td></tr></table></figure><a id="more"></a>



<h3 id="æ•°æ®è£…è½½"><a href="#æ•°æ®è£…è½½" class="headerlink" title="æ•°æ®è£…è½½"></a>æ•°æ®è£…è½½</h3><blockquote>
<p>æ•°æ®æ„æˆ: [feature 1, â€¦ feature n; &gt;= 50k or &lt; 50k] ğŸ˜µğŸ˜µğŸ˜µ<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadData</span><span class="params">(_x, _y, fileName)</span>:</span></span><br><span class="line">    col_1 = [<span class="string">' State-gov'</span>, </span><br><span class="line">              <span class="string">' Self-emp-not-inc'</span>, </span><br><span class="line">              <span class="string">' Private'</span>, </span><br><span class="line">              <span class="string">' Federal-gov'</span>, </span><br><span class="line">              <span class="string">' Local-gov'</span>, </span><br><span class="line">              <span class="string">' ?'</span>, </span><br><span class="line">              <span class="string">' Self-emp-inc'</span>, </span><br><span class="line">              <span class="string">' Without-pay'</span>, </span><br><span class="line">              <span class="string">' Never-worked'</span>]</span><br><span class="line">    col_3 = [<span class="string">' Bachelors'</span>, </span><br><span class="line">              <span class="string">' HS-grad'</span>, </span><br><span class="line">              <span class="string">' 11th'</span>, </span><br><span class="line">              <span class="string">' Masters'</span>, </span><br><span class="line">              <span class="string">' 9th'</span>, </span><br><span class="line">              <span class="string">' Some-college'</span>, </span><br><span class="line">              <span class="string">' Assoc-acdm'</span>, </span><br><span class="line">              <span class="string">' Assoc-voc'</span>, </span><br><span class="line">              <span class="string">' 7th-8th'</span>, </span><br><span class="line">              <span class="string">' Doctorate'</span>, </span><br><span class="line">              <span class="string">' Prof-school'</span>, </span><br><span class="line">              <span class="string">' 5th-6th'</span>, </span><br><span class="line">              <span class="string">' 10th'</span>, </span><br><span class="line">              <span class="string">' 1st-4th'</span>, </span><br><span class="line">              <span class="string">' Preschool'</span>, </span><br><span class="line">              <span class="string">' 12th'</span>]</span><br><span class="line">    col_5 = [<span class="string">' Never-married'</span>, </span><br><span class="line">              <span class="string">' Married-civ-spouse'</span>, </span><br><span class="line">              <span class="string">' Divorced'</span>, </span><br><span class="line">              <span class="string">' Married-spouse-absent'</span>, </span><br><span class="line">              <span class="string">' Separated'</span>, </span><br><span class="line">              <span class="string">' Married-AF-spouse'</span>, </span><br><span class="line">              <span class="string">' Widowed'</span>]</span><br><span class="line">    col_6 = [<span class="string">' Adm-clerical'</span>, </span><br><span class="line">              <span class="string">' Exec-managerial'</span>, </span><br><span class="line">              <span class="string">' Handlers-cleaners'</span>, </span><br><span class="line">              <span class="string">' Prof-specialty'</span>, </span><br><span class="line">              <span class="string">' Other-service'</span>, </span><br><span class="line">              <span class="string">' Sales'</span>, </span><br><span class="line">              <span class="string">' Craft-repair'</span>, </span><br><span class="line">              <span class="string">' Transport-moving'</span>, </span><br><span class="line">              <span class="string">' Farming-fishing'</span>, </span><br><span class="line">              <span class="string">' Machine-op-inspct'</span>, </span><br><span class="line">              <span class="string">' Tech-support'</span>, </span><br><span class="line">              <span class="string">' ?'</span>, </span><br><span class="line">              <span class="string">' Protective-serv'</span>, </span><br><span class="line">              <span class="string">' Armed-Forces'</span>, </span><br><span class="line">              <span class="string">' Priv-house-serv'</span>]</span><br><span class="line">    col_7 = [<span class="string">' Not-in-family'</span>, </span><br><span class="line">              <span class="string">' Husband'</span>, </span><br><span class="line">              <span class="string">' Wife'</span>, </span><br><span class="line">              <span class="string">' Own-child'</span>, </span><br><span class="line">              <span class="string">' Unmarried'</span>, </span><br><span class="line">              <span class="string">' Other-relative'</span>]</span><br><span class="line">    col_8 = [<span class="string">' White'</span>, </span><br><span class="line">              <span class="string">' Black'</span>, </span><br><span class="line">              <span class="string">' Asian-Pac-Islander'</span>, </span><br><span class="line">              <span class="string">' Amer-Indian-Eskimo'</span>, </span><br><span class="line">              <span class="string">' Other'</span>]</span><br><span class="line">    col_9 = [<span class="string">' Male'</span>, <span class="string">' Female'</span>]</span><br><span class="line">    col_13 = [<span class="string">' United-States'</span>, </span><br><span class="line">              <span class="string">' Cuba'</span>, </span><br><span class="line">              <span class="string">' Jamaica'</span>, </span><br><span class="line">              <span class="string">' India'</span>, </span><br><span class="line">              <span class="string">' ?'</span>, </span><br><span class="line">              <span class="string">' Mexico'</span>, </span><br><span class="line">              <span class="string">' South'</span>, </span><br><span class="line">              <span class="string">' Puerto-Rico'</span>, </span><br><span class="line">              <span class="string">' Honduras'</span>, </span><br><span class="line">              <span class="string">' England'</span>, </span><br><span class="line">              <span class="string">' Canada'</span>, </span><br><span class="line">              <span class="string">' Germany'</span>, </span><br><span class="line">              <span class="string">' Iran'</span>, </span><br><span class="line">              <span class="string">' Philippines'</span>, </span><br><span class="line">              <span class="string">' Italy'</span>, </span><br><span class="line">              <span class="string">' Poland'</span>, </span><br><span class="line">              <span class="string">' Columbia'</span>, </span><br><span class="line">              <span class="string">' Cambodia'</span>, </span><br><span class="line">              <span class="string">' Thailand'</span>, </span><br><span class="line">              <span class="string">' Ecuador'</span>, </span><br><span class="line">              <span class="string">' Laos'</span>, </span><br><span class="line">              <span class="string">' Taiwan'</span>, </span><br><span class="line">              <span class="string">' Haiti'</span>, </span><br><span class="line">              <span class="string">' Portugal'</span>, </span><br><span class="line">              <span class="string">' Dominican-Republic'</span>, </span><br><span class="line">              <span class="string">' El-Salvador'</span>, </span><br><span class="line">              <span class="string">' France'</span>, </span><br><span class="line">              <span class="string">' Guatemala'</span>, </span><br><span class="line">              <span class="string">' China'</span>, </span><br><span class="line">              <span class="string">' Japan'</span>, </span><br><span class="line">              <span class="string">' Yugoslavia'</span>, </span><br><span class="line">              <span class="string">' Peru'</span>, </span><br><span class="line">              <span class="string">' Outlying-US(Guam-USVI-etc)'</span>, </span><br><span class="line">              <span class="string">' Scotland'</span>, </span><br><span class="line">              <span class="string">' Trinadad&amp;Tobago'</span>, </span><br><span class="line">              <span class="string">' Greece'</span>, </span><br><span class="line">              <span class="string">' Nicaragua'</span>, </span><br><span class="line">              <span class="string">' Vietnam'</span>, </span><br><span class="line">              <span class="string">' Hong'</span>, </span><br><span class="line">              <span class="string">' Ireland'</span>, </span><br><span class="line">              <span class="string">' Hungary'</span>, </span><br><span class="line">              <span class="string">' Holand-Netherlands'</span>]</span><br><span class="line">    col_14 = [<span class="string">' &lt;=50K'</span>, <span class="string">' &gt;50K'</span>, <span class="string">' &lt;=50K.'</span>, <span class="string">' &gt;50K.'</span>]</span><br><span class="line">    <span class="keyword">with</span> open(fileName) <span class="keyword">as</span> rawData:</span><br><span class="line">        rows = csv.reader(rawData, delimiter = <span class="string">","</span>)</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> rows:</span><br><span class="line">            <span class="keyword">if</span> len(r) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            temp = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>):</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                    temp.append(float(r[i]))</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_1:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">2</span>:</span><br><span class="line">                    temp.append(float(r[i]))</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">3</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_3:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">4</span>:</span><br><span class="line">                    temp.append(float(r[i]))</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">5</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_5:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">6</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_6:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">7</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_7:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">8</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_8:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">9</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_9:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">10</span> <span class="keyword">or</span> i == <span class="number">11</span> <span class="keyword">or</span> i == <span class="number">12</span>:</span><br><span class="line">                    temp.append(float(r[i]))</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">13</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_13:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            temp.append(float(cnt))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">14</span>:</span><br><span class="line">                    cnt = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> col_14:</span><br><span class="line">                        <span class="keyword">if</span> c == r[i]:</span><br><span class="line">                            _y.append(float(cnt % <span class="number">2</span>))</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        cnt += <span class="number">1</span></span><br><span class="line">            _x.append(temp)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="æ¨¡å‹å®šä¹‰"><a href="#æ¨¡å‹å®šä¹‰" class="headerlink" title="æ¨¡å‹å®šä¹‰"></a>æ¨¡å‹å®šä¹‰</h2><h3 id="Feature-Scaling"><a href="#Feature-Scaling" class="headerlink" title="Feature Scaling"></a>Feature Scaling</h3><blockquote>
<p>4ç§ Feature Scalingçš„æ–¹æ³•</p>
</blockquote>
<h4 id="Standardization"><a href="#Standardization" class="headerlink" title="Standardization"></a>Standardization</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardization</span><span class="params">(dataMatrix)</span>:</span> <span class="comment">#ğŸ¤©ğŸ¤©ğŸ¤©</span></span><br><span class="line">    <span class="keyword">if</span> dataMatrix.shape[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> dataMatrix</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dataMatrix.shape[<span class="number">1</span>]):</span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            sum += _x[i]</span><br><span class="line">        mean = sum / dataMatrix.shape[<span class="number">0</span>]</span><br><span class="line">        SD = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            SD += (_x[i] - mean)**<span class="number">2</span></span><br><span class="line">        SD = np.sqrt(SD / dataMatrix.shape[<span class="number">0</span>])</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">for</span> _x <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            _x[i] = (_x[i] - mean) / SD</span><br><span class="line">    <span class="keyword">return</span> dataMatrix</span><br></pre></td></tr></table></figure>
<h4 id="Mean-Normalization"><a href="#Mean-Normalization" class="headerlink" title="Mean Normalization"></a>Mean Normalization</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">meanNormalization</span><span class="params">(dataMatrix)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> dataMatrix.shape[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> dataMatrix</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dataMatrix.shape[<span class="number">1</span>]):</span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line">        max = <span class="number">0</span></span><br><span class="line">        min = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            sum += data[i]</span><br><span class="line">            <span class="keyword">if</span> data[i] &gt; max:</span><br><span class="line">                max = data[i]</span><br><span class="line">            <span class="keyword">if</span> data[i] &lt; min:</span><br><span class="line">                min = data[i]</span><br><span class="line">        mean = sum / dataMatrix.shape[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> (max - min) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">                data[i] = (data[i] - mean) / (max - min)</span><br><span class="line">    <span class="keyword">return</span> dataMatrix</span><br></pre></td></tr></table></figure>
<h4 id="Rescaling"><a href="#Rescaling" class="headerlink" title="Rescaling"></a>Rescaling</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rescaling</span><span class="params">(dataMatrix)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> dataMatrix.shape[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> dataMatrix</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dataMatrix.shape[<span class="number">1</span>]):</span><br><span class="line">        max = <span class="number">0</span></span><br><span class="line">        min = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">            <span class="keyword">if</span> data[i] &gt; max:</span><br><span class="line">                max = data[i]</span><br><span class="line">            <span class="keyword">if</span> data[i] &lt; min:</span><br><span class="line">                min = data[i]</span><br><span class="line">        <span class="keyword">if</span> max - min != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> data <span class="keyword">in</span> dataMatrix:</span><br><span class="line">                data[i] = (data[i] - min) / (max - min)</span><br><span class="line">    <span class="keyword">return</span> dataMatrix</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä½¿ç”¨ä»¥ä¸ŠæŸä¸€ç§æ–¹æ³•å¯¹æ•°æ®è¿›è¡ŒFeature Scaling<br>ç»è¿‡æµ‹è¯•,Standardizationçš„æ•ˆæœæœ€å¥½,å…¶æ¬¡æ˜¯ Mean Normalization </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">trainX = []</span><br><span class="line">trainY = []</span><br><span class="line">testX = []</span><br><span class="line">testY = []</span><br><span class="line">loadData(trainX, trainY, <span class="string">'train.csv'</span>)</span><br><span class="line">loadData(testX, testY, <span class="string">'test.csv'</span>)</span><br><span class="line">trainX = np.array(trainX)</span><br><span class="line">trainY = np.array(trainY)</span><br><span class="line">testX = np.array(testX)</span><br><span class="line">testY = np.array(testY)</span><br><span class="line">trainX = standardization(trainX) <span class="comment">#Test accuracy: 0.8504391622392502</span></span><br><span class="line">testX = standardization(testX)</span><br><span class="line"><span class="comment"># trainX = meanNormalization(trainX) #Test accuracy: 0.8516675879786739</span></span><br><span class="line"><span class="comment"># testX = meanNormalization(testX)</span></span><br><span class="line"><span class="comment"># trainX = rescaling(trainX) #Test accuracy: 0.8477366255400303</span></span><br><span class="line"><span class="comment"># testX = rescaling(testX)</span></span><br></pre></td></tr></table></figure>
<h3 id="è®­ç»ƒ"><a href="#è®­ç»ƒ" class="headerlink" title="è®­ç»ƒ"></a>è®­ç»ƒ</h3><h4 id="è®¾è®¡æ¨¡å‹"><a href="#è®¾è®¡æ¨¡å‹" class="headerlink" title="è®¾è®¡æ¨¡å‹"></a>è®¾è®¡æ¨¡å‹</h4><blockquote>
<p>ä½¿ç”¨ä¸¤å±‚layers æ¿€æ´»å‡½æ•° ReLU <del>(å°±ä¹±è®¾è®¡çš„)</del> ğŸ˜…<br>Loss Function ç”¨çš„æ˜¯Cross Entropy, å› ä¸ºä½¿ç”¨äº†ReLUç”¨Square Errorä¼šæœ‰è®¸å¤šçš„åœ°æ–¹æ²¡æœ‰æ¢¯åº¦,å¾ˆå°´å°¬ğŸ¥µ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    keras.layers.Dense(<span class="number">28</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">14</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">2</span>,activation=tf.nn.softmax)</span><br><span class="line">])</span><br><span class="line">model.compile(optimizer=tf.train.AdamOptimizer(), </span><br><span class="line">              loss=<span class="string">'sparse_categorical_crossentropy'</span>, </span><br><span class="line">              metrics=[<span class="string">'accuracy'</span>])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è®­ç»ƒæ—¶çš„ç²¾å‡†åº¦:</p>
</blockquote>
<p><img src="/images/Winner/acc.png" alt="acc"></p>
<blockquote>
<p>æµ‹è¯•ç²¾å‡†åº¦:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">16281/16281 [==============================] - 0s 25us/step</span><br><span class="line">Test loss:  0.3315070253370084   Test accuracy: 0.8466310422863189</span><br></pre></td></tr></table></figure>
<h2 id="è´Ÿä¼˜åŒ–"><a href="#è´Ÿä¼˜åŒ–" class="headerlink" title="è´Ÿä¼˜åŒ–"></a>è´Ÿä¼˜åŒ–</h2><h3 id="å–æ¶ˆFeature-Scaling"><a href="#å–æ¶ˆFeature-Scaling" class="headerlink" title="å–æ¶ˆFeature Scaling"></a>å–æ¶ˆFeature Scaling</h3><blockquote>
<p>å¾ˆçœŸå®  ğŸ¥µ</p>
</blockquote>
<p><img src="/images/Winner/nonfs.png" alt="non-fs"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">16281/16281 [==============================] - 0s 24us/step</span><br><span class="line">Test loss:  12.310577790542826   Test accuracy: 0.23622627602315244</span><br></pre></td></tr></table></figure>
<h3 id="å¢åŠ layers"><a href="#å¢åŠ layers" class="headerlink" title="å¢åŠ layers"></a>å¢åŠ layers</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model = tf.keras.Sequential([</span><br><span class="line">    keras.layers.Dense(<span class="number">28</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">28</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">14</span>, activation=tf.nn.relu),</span><br><span class="line">    keras.layers.Dense(<span class="number">2</span>,activation=tf.nn.softmax)</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ²¡ç”¨ğŸ¤¦â€ ğŸ¤¦â€ ğŸ¤·â€ ğŸ¤·â€</p>
</blockquote>
<p><img src="/images/Winner/more.png" alt="more layer"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">16281/16281 [==============================] - 0s 26us/step</span><br><span class="line">Test loss:  0.33134235454223626   Test accuracy: 0.8481665745274117</span><br></pre></td></tr></table></figure>
<p>å®Œç»“ğŸ‰ğŸ‰ğŸ‰</p>
<h2 id="Repo"><a href="#Repo" class="headerlink" title="Repo"></a>Repo</h2><p><a href="https://github.com/VIXNESS/machine-learning-course/tree/master/winner" target="_blank" rel="noopener">&gt;50K?</a></p>
]]></content>
      <categories>
        <category>machine learning</category>
      </categories>
      <tags>
        <tag>machine learning</tag>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title>Java Note</title>
    <url>/2020/07/31/Java-Note/</url>
    <content><![CDATA[<h1 id="Java-Note"><a href="#Java-Note" class="headerlink" title="Java Note"></a>Java Note</h1><h2 id="I-è™šæ‹Ÿæœºå†…å­˜å¸ƒå±€"><a href="#I-è™šæ‹Ÿæœºå†…å­˜å¸ƒå±€" class="headerlink" title="I è™šæ‹Ÿæœºå†…å­˜å¸ƒå±€"></a>I è™šæ‹Ÿæœºå†…å­˜å¸ƒå±€</h2><h3 id="1-JVMè¿è¡Œæ—¶-å†…å­˜å¸ƒå±€"><a href="#1-JVMè¿è¡Œæ—¶-å†…å­˜å¸ƒå±€" class="headerlink" title="1. JVMè¿è¡Œæ—¶ å†…å­˜å¸ƒå±€"></a>1. JVMè¿è¡Œæ—¶ å†…å­˜å¸ƒå±€</h3><table>
<thead>
<tr>
<th>åŒºåŸŸ</th>
<th>ä½œç”¨</th>
<th>çº¿ç¨‹å†…å­˜å…±äº«</th>
<th>å¼‚å¸¸</th>
<th>å¼‚å¸¸åŸå› </th>
</tr>
</thead>
<tbody>
<tr>
<td>æ–¹æ³•åŒº</td>
<td>å­˜æ”¾ç±»å‹ä¿¡æ¯, å¸¸é‡, é™æ€å˜é‡, JITä»£ç ç¼“å­˜.</td>
<td>çº¿ç¨‹å…±äº«</td>
<td>OOM</td>
<td>JVMè§„èŒƒè§„å®š, æ— æ³•æ»¡è¶³å†…å­˜åˆ†é…æ—¶å¯æŠ›å‡º.</td>
</tr>
<tr>
<td>è™šæ‹Ÿæœºæ ˆ</td>
<td>å­˜å‚¨å±€éƒ¨å˜é‡, æ“ä½œæ•°æ ˆ,  åŠ¨æ€é“¾æ¥, æ¥å£ç­‰.</td>
<td>çº¿ç¨‹ç§æœ‰</td>
<td>OOM, SO</td>
<td>SO: æ ˆæ·±åº¦è¶…å‡ºJVMå…è®¸èŒƒå›´;<br>OOM: æ ˆæ‰©å±•å¤±è´¥å¯¼è‡´çš„å†…å­˜åˆ†é…ä¸è¶³.</td>
</tr>
<tr>
<td>æœ¬åœ°æ–¹æ³•æ ˆ</td>
<td>ä¸è™šæ‹Ÿæœºæ ˆåŠŸèƒ½ç›¸åŒ, ä½†æ˜¯å¯¹è±¡æ˜¯æœ¬åœ°æ–¹æ³•(Native Method).</td>
<td>çº¿ç¨‹ç§æœ‰</td>
<td>OOM, SO</td>
<td>åŒä¸Š.</td>
</tr>
<tr>
<td>å †</td>
<td>ç»å¤§éƒ¨åˆ†å¯¹è±¡åœ¨æ­¤å­˜å‚¨(é™¤äº†æ ˆä¸Šåˆ†é…å’Œæ ‡é‡æ›¿æ¢çš„å¯¹è±¡).</td>
<td>å…±äº«/ç§æœ‰(TLAB)</td>
<td>OOM</td>
<td>å †ä¸­æ— æ³•å®Œæˆå®ä¾‹åˆ†é…æ—¶æŠ›å‡º.</td>
</tr>
<tr>
<td>PCè®¡æ•°å™¨</td>
<td>ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</td>
<td>çº¿ç¨‹ç§æœ‰</td>
<td>æ— </td>
<td>æ— </td>
</tr>
</tbody>
</table><a id="more"></a>
<blockquote>
<p>OOM: OutOfMemoryError</p>
<p>SO: StackOverFlowError</p>
<p>TLAB: çº¿ç¨‹ç§æœ‰åˆ†é…ç¼“å†²åŒº Thread Local Allocation Buffer</p>
</blockquote>
<h3 id="2-å¯¹è±¡å†…å­˜å¸ƒå±€"><a href="#2-å¯¹è±¡å†…å­˜å¸ƒå±€" class="headerlink" title="2. å¯¹è±¡å†…å­˜å¸ƒå±€"></a>2. å¯¹è±¡å†…å­˜å¸ƒå±€</h3><p>å †ä¸­å¯¹è±¡çš„å¸ƒå±€: å¯¹è±¡å¤´ + æ•°æ® + å¯¹å…¶å¡«å…….</p>
<p>å¯¹è±¡å¤´: é”ä¿¡æ¯, GCä¿¡æ¯, åå‘ä¿¡æ¯.</p>
<h3 id="3-å¯¹è±¡è®¿é—®"><a href="#3-å¯¹è±¡è®¿é—®" class="headerlink" title="3. å¯¹è±¡è®¿é—®"></a>3. å¯¹è±¡è®¿é—®</h3><h4 id="3-1-å¥æŸ„è®¿é—®"><a href="#3-1-å¥æŸ„è®¿é—®" class="headerlink" title="3.1 å¥æŸ„è®¿é—®"></a>3.1 å¥æŸ„è®¿é—®</h4><p><img src="/images/Java_Note/0.png" alt="å¥æŸ„"> </p>
<h4 id="3-2-æŒ‡é’ˆè®¿é—®"><a href="#3-2-æŒ‡é’ˆè®¿é—®" class="headerlink" title="3.2 æŒ‡é’ˆè®¿é—®"></a>3.2 æŒ‡é’ˆè®¿é—®</h4><p><img src="/images/Java_Note/1.png" alt="æŒ‡é’ˆ"> </p>
<h2 id="II-åƒåœ¾å›æ”¶ç­–ç•¥"><a href="#II-åƒåœ¾å›æ”¶ç­–ç•¥" class="headerlink" title="II åƒåœ¾å›æ”¶ç­–ç•¥"></a>II åƒåœ¾å›æ”¶ç­–ç•¥</h2><h3 id="1-å›æ”¶ç†è®º"><a href="#1-å›æ”¶ç†è®º" class="headerlink" title="1. å›æ”¶ç†è®º"></a>1. å›æ”¶ç†è®º</h3><h4 id="å¯¹è±¡å­˜æ´»åˆ¤å®š"><a href="#å¯¹è±¡å­˜æ´»åˆ¤å®š" class="headerlink" title="å¯¹è±¡å­˜æ´»åˆ¤å®š"></a>å¯¹è±¡å­˜æ´»åˆ¤å®š</h4><p>åº”å›æ”¶å¯¹è±¡çš„åˆ¤æ–­: å¯è¾¾æ€§åˆ†æ.</p>
<blockquote>
<p>å¯è¾¾æ€§åˆ†æ:</p>
<p>ä»¥ä¸€äº›å¯ä½œä¸ºGC Rootçš„å¯¹è±¡ä¸ºæ ¹çš„ä¸€æ£µç”±å¼•ç”¨å…³ç³»å»ºç«‹èµ·æ¥çš„æ ‘, å½“æ ‘æ ¹æ­»å», æ•´ä¸ªæ£µæ ‘ä¸Šçš„å¯¹è±¡éƒ½å°†ä¸å¯è¾¾.</p>
<p>ä»€ä¹ˆå¯¹è±¡å¯ä½œä¸ºGC Root:</p>
<ul>
<li>è™šæ‹Ÿæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡</li>
<li>æ–¹æ³•åŒºä¸­é™æ€å˜é‡æ‰€å¼•ç”¨çš„å˜é‡</li>
<li>å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li>
<li>JVMå†…éƒ¨å¼•ç”¨(ä¾‹å¦‚ä¸€äº›Classå¯¹è±¡, å¼‚å¸¸å¯¹è±¡, ç±»åŠ è½½å™¨)</li>
<li>synchronizedæŒæœ‰çš„å¯¹è±¡</li>
</ul>
</blockquote>
<h4 id="åˆ†ä»£å‡è¯´"><a href="#åˆ†ä»£å‡è¯´" class="headerlink" title="åˆ†ä»£å‡è¯´"></a>åˆ†ä»£å‡è¯´</h4><ul>
<li>å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„.</li>
<li>å‡ æ¬¡GCä¹‹åä»ç„¶å­˜æ´»çš„å¯¹è±¡æ˜¯ä¸æœ½çš„.</li>
<li>è·¨ä»£å¼•ç”¨(æ–°ç”Ÿä»£, è€å¹´ä»£ä¹‹é—´çš„å¼•ç”¨) æ˜¯æå°‘çš„.</li>
</ul>
<p>æ‰€ä»¥å°†éœ€è¦GCçš„åŒºåŸŸåˆ†ä¸ºEdenåŒºå’ŒSurvivorsåŒº.</p>
<p>æ–°å»ºç«‹çš„å¯¹è±¡æ”¾åœ¨EdenåŒº.</p>
<p>ç»è¿‡å‡ ä»£GCä»ç„¶å­˜æ´»çš„å¯¹è±¡æ”¾å…¥SurvivorsåŒº.</p>
<h4 id="å›æ”¶ç®—æ³•"><a href="#å›æ”¶ç®—æ³•" class="headerlink" title="å›æ”¶ç®—æ³•"></a>å›æ”¶ç®—æ³•</h4><ol>
<li>æ ‡è®° - æ¸…é™¤:  (äº§ç”Ÿå¤§é‡ç¢ç‰‡)<ol>
<li>å…ˆæ ‡è®°éœ€è¦å›æ”¶çš„å¯¹è±¡.</li>
<li>æ¸…é™¤å¯¹è±¡.</li>
</ol>
</li>
<li>æ ‡è®° - å¤åˆ¶: (å°†åŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸ, å›æ”¶æ—¶ä»ä¸€ä¸ªåŒºåŸŸæŠŠå­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªåŒºåŸŸ, å¹¶ä¸”ç´§å¯†æ’åˆ—)<ol>
<li>å…ˆæ ‡è®°è¦å›æ”¶çš„å¯¹è±¡.</li>
<li>å¤åˆ¶å­˜æ´»åˆ°å¯¹è±¡åˆ°å¦ä¸€ä¸ªåŠåŒº.</li>
</ol>
</li>
<li>æ ‡è®° - æ•´ç†: (ç§»åŠ¨æ¯æ¬¡éƒ½å­˜æ´»çš„è€å¹´ä»£ä»£ä»·æ˜¯éå¸¸é«˜çš„, è€Œä¸”éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹)<ol>
<li>å…ˆæ ‡è®°è¦å›æ”¶çš„å¯¹è±¡.</li>
<li>å°†å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ•´ç†, ä½¿å…¶ç´§å¯†æ’åˆ—.</li>
</ol>
</li>
</ol>
<h3 id="2-å›æ”¶æ—¶æœº"><a href="#2-å›æ”¶æ—¶æœº" class="headerlink" title="2. å›æ”¶æ—¶æœº"></a>2. å›æ”¶æ—¶æœº</h3><p>å¼ºå¼•ç”¨: ä¸€èˆ¬çš„å£°æ˜çš„å¯¹è±¡, åªè¦å…³ç³»å­˜åœ¨, ä¸ä¼šè¢«å›æ”¶.</p>
<p>è½¯å¼•ç”¨: éå¿…é¡»å¯¹è±¡,  SoftReference,  åœ¨å†…å­˜æº¢å‡ºä¹‹å‰ä¼˜å…ˆå›æ”¶.</p>
<p>å¼±å¼•ç”¨: éå¿…é¡»å¯¹è±¡, WeakReference, ä¸€æ—¦è§¦å‘GCå°±ç«‹åˆ»å›æ”¶.</p>
<p>è™šå¼•ç”¨: ä¸å½±å“å¯¹è±¡çš„å£°æ˜èµ°èµ·, PhantomReference, æ— æ³•å–å¾—å®ä¾‹æ•°æ®, åªèƒ½ç”¨äºæ¥å—GCå›æ”¶çš„é€šçŸ¥.</p>
<p>Minor GCè§¦å‘:  å®ä¾‹åˆ†é…å¤±è´¥, EdenåŒºæ»¡äº†.</p>
<p>Full GCè§¦å‘:  <code>System.gc()</code> , heap dump,  SurvivoråŒºçš„å¤§å°æ— æ³•æ»¡è¶³Minor GCåçš„å¯¹è±¡.</p>
<blockquote>
<p>Minor GC: åªå›æ”¶æ–°ç”Ÿä»£</p>
</blockquote>
<h3 id="3-å›æ”¶å™¨ä¾‹ä¸¾"><a href="#3-å›æ”¶å™¨ä¾‹ä¸¾" class="headerlink" title="3. å›æ”¶å™¨ä¾‹ä¸¾"></a>3. å›æ”¶å™¨ä¾‹ä¸¾</h3><h4 id="3-1-Serial-ParNew"><a href="#3-1-Serial-ParNew" class="headerlink" title="3.1 Serial / ParNew"></a>3.1 Serial / ParNew</h4><p>æ–°ç”Ÿä»£: æ ‡è®° - å¤åˆ¶</p>
<p>è€å¹´ä»£: æ ‡è®° - æ¸…ç†</p>
<h4 id="3-2-CMS-æ³¨é‡å“åº”æ—¶é—´-åœé¡¿æ—¶é—´çŸ­"><a href="#3-2-CMS-æ³¨é‡å“åº”æ—¶é—´-åœé¡¿æ—¶é—´çŸ­" class="headerlink" title="3.2 CMS(æ³¨é‡å“åº”æ—¶é—´, åœé¡¿æ—¶é—´çŸ­)"></a>3.2 CMS(æ³¨é‡å“åº”æ—¶é—´, åœé¡¿æ—¶é—´çŸ­)</h4><p>ä½¿ç”¨æ ‡è®° - æ¸…é™¤ç®—æ³•. </p>
<ol>
<li>åˆå§‹æ ‡è®°: æ ‡è®°GC Rootç›´æ¥å…³è”çš„å¯¹è±¡. (éœ€è¦Stop The World)</li>
<li>å¹¶å‘æ ‡è®°: ä»GC Rootå¼€å§‹éå†å¯¹è±¡å›¾. </li>
<li>é‡æ–°æ ‡è®°: ä¿®æ­£å¹¶å‘æ ‡è®°æ—¶å¯¹è±¡çš„å˜åŠ¨. (éœ€è¦Stop The World)</li>
<li>å¹¶å‘æ¸…é™¤. <strong>(Major GC)</strong></li>
</ol>
<blockquote>
<ul>
<li>CMSæ— æ³•å¤„ç†<strong>æµ®åŠ¨åƒåœ¾</strong>,  å› è€Œå¼•å‘ä¸€æ¬¡Full GC. (æµ®åŠ¨åƒåœ¾æ˜¯æŒ‡CMSåœ¨å¹¶å‘æ¸…ç†çš„æ—¶å€™, ä¼´éšç€äº§ç”Ÿçš„æ–°åƒåœ¾å¯¹è±¡.)</li>
<li>CMSæ”¶é›†å®Œæˆå, å†…å­˜ç©ºé—´æœ‰ç¢ç‰‡å­˜åœ¨.</li>
</ul>
</blockquote>
<h4 id="3-3-G1-Mixed-GC"><a href="#3-3-G1-Mixed-GC" class="headerlink" title="3.3 G1 (Mixed GC)"></a>3.3 G1 (Mixed GC)</h4><blockquote>
<p> G1å°†ç©ºé—´åˆ†ä¸ºå¤§å°ä¸ä¸€çš„Region, æ¯ä¸ªRegionå¯ä½œä¸ºEden, Survivorç©ºé—´.</p>
</blockquote>
<p>GCæ­¥éª¤:</p>
<ol>
<li>åˆå§‹æ ‡è®°: åŒCMS(éœ€è¦Stop The World)</li>
<li>å¹¶å‘æ ‡è®°: åŒCMS</li>
<li>æœ€ç»ˆæ ‡è®°: ä¿®æ­£å¹¶å‘æ ‡è®°æ—¶å¯¹è±¡çš„å˜åŠ¨. (éœ€è¦Stop The World)</li>
<li>ç­›é€‰å›æ”¶: æ ¹æ®Regionçš„ç»Ÿè®¡æ•°æ®å¯¹Regionè¿›è¡Œå›æ”¶</li>
</ol>
<h4 id="3-4-ZGC"><a href="#3-4-ZGC" class="headerlink" title="3.4 ZGC"></a>3.4 ZGC</h4><blockquote>
<p>ä¸G1ä¸€æ ·, ä¹Ÿæ˜¯ä½¿ç”¨å¤§å°ä¸åŒçš„Regionæ‹†åˆ†å›æ”¶åŒºåŸŸ.</p>
<p>å¹¶ä¸”ä½¿ç”¨æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯.(å…·ä½“åŸç†ç•¥)</p>
</blockquote>
<p>GCæ­¥éª¤:</p>
<ol>
<li>å¹¶å‘æ ‡è®°: åŒCMS</li>
<li>å¹¶å‘é¢„å¤‡é‡åˆ†é…: æ ¹æ®æŸ¥è¯¢æ¡ä»¶ç»Ÿè®¡å‡ºéœ€è¦å›æ”¶çš„Region.</li>
<li>å¹¶å‘é‡åˆ†é…: æŠŠé›†ä¸­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°æ–°Regionä¸Š.</li>
<li>å¹¶å‘é‡æ˜ å°„: ä¿®æ­£å †ä¸­æŒ‡å‘æ—§å¯¹è±¡çš„å¼•ç”¨.</li>
</ol>
<h2 id="III-ç±»åŠ è½½æœºåˆ¶"><a href="#III-ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="III ç±»åŠ è½½æœºåˆ¶"></a>III ç±»åŠ è½½æœºåˆ¶</h2><h3 id="1-ç±»åŠ è½½æ­¥éª¤"><a href="#1-ç±»åŠ è½½æ­¥éª¤" class="headerlink" title="1. ç±»åŠ è½½æ­¥éª¤"></a>1. ç±»åŠ è½½æ­¥éª¤</h3><ol>
<li><p>åŠ è½½: ä»ä¸åŒçš„æºå¤´è¯»å–äºŒè¿›åˆ¶å­—èŠ‚æµ, å¹¶ä¸”åˆ›å»ºClasså¯¹è±¡.</p>
</li>
<li><p>éªŒè¯: éªŒè¯æ–‡ä»¶.</p>
</li>
<li><p>å‡†å¤‡: ä¸ºé™æ€å˜é‡è®¾å®šåˆå§‹å€¼(ä¸æ˜¯èµ‹è¯­å¥ä¸­å®šä¹‰çš„å€¼, è€Œæ˜¯å„ç±»å‹çš„é»˜è®¤å€¼, ä¾‹å¦‚intçš„é»˜è®¤å€¼æ˜¯0). åˆå§‹åœ¨æ–¹æ³•åŒº.</p>
</li>
<li><p>è§£æ: å°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨. (åŒ…æ‹¬ç±»ã€æ¥å£çš„è§£æ, å­—æ®µçš„è§£æ, æ–¹æ³•çš„è§£æ, æ¥å£æ–¹æ³•çš„è§£æ)</p>
</li>
<li><p>åˆå§‹åŒ–: åˆå§‹åŒ–å˜é‡, èµ‹å€¼å®é™…çš„å€¼ç»™å˜é‡. æ‰§è¡Œç±»æ„é€ å™¨\&lt;clinit>().</p>
</li>
</ol>
<h3 id="2-ç±»åŠ è½½å™¨"><a href="#2-ç±»åŠ è½½å™¨" class="headerlink" title="2. ç±»åŠ è½½å™¨"></a>2. ç±»åŠ è½½å™¨</h3><blockquote>
<p>ä¸åŒç±»åŠ è½½å™¨åŠ è½½çš„åŒä¸€ä¸ªç±»åœ¨JVMä¸­ä¸è§†ä¸ºåŒä¸€ä¸ªç±».</p>
</blockquote>
<h4 id="ç±»åŠ è½½æœºåˆ¶"><a href="#ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="ç±»åŠ è½½æœºåˆ¶"></a>ç±»åŠ è½½æœºåˆ¶</h4><p><strong>åŒäº²å§”æ´¾æ¨¡å‹</strong> (é€’å½’åŠ è½½)</p>
<ol>
<li>é‡åˆ°è¦åŠ è½½çš„ç±»ä¼˜å…ˆäº¤ç”±çˆ¶ç±»åŠ è½½.</li>
<li>çˆ¶ç±»æ— æ³•åŠ è½½çš„ç±»å†ç”±å­ç±»åŠ è½½.</li>
</ol>
<p><strong>éåŒäº²å§”æ´¾æ¨¡å‹</strong></p>
<ol>
<li>çº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨: å¯ç”±çˆ¶ç±»è¯·æ±‚å­ç±»ç±»åŠ è½½å™¨åŠ è½½.</li>
<li>æ¨¡å—åŒ–ç³»ç»Ÿ:  è‹¥å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æ¨¡å—ç±»åŠ è½½å™¨, ä¼˜å…ˆæ´¾å‘ç»™å…¶åŠ è½½. å¦åˆ™äº¤ç”±çˆ¶ç±»åŠ è½½.</li>
</ol>
<h3 id="3-åå°„ç³»ç»Ÿ"><a href="#3-åå°„ç³»ç»Ÿ" class="headerlink" title="3. åå°„ç³»ç»Ÿ"></a>3. åå°„ç³»ç»Ÿ</h3><p>åå°„ç³»ç»Ÿä¸»è¦æ˜¯åŸºäºClasså¯¹è±¡çš„æ“ä½œ.</p>
<p>å½“ç±»åŠ è½½å™¨ä»ä¸åŒæ¸ é“åŠ è½½å®ŒJavaç±»å, éƒ½ä¼šå½¢æˆè¿™ä¸ªç±»åŠ è½½å™¨ä¸‹ä¸€ä¸€å¯¹åº”çš„Classå¯¹è±¡(å½“ç„¶, ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½çš„åŒä¸€ä¸ªç±»ä¸æ˜¯åŒä¸€ä¸ªClasså¯¹è±¡).</p>
<h2 id="IV-å¤šçº¿ç¨‹å¹¶å‘"><a href="#IV-å¤šçº¿ç¨‹å¹¶å‘" class="headerlink" title="IV å¤šçº¿ç¨‹å¹¶å‘"></a>IV å¤šçº¿ç¨‹å¹¶å‘</h2><h3 id="1-å†…å­˜æ¨¡å‹"><a href="#1-å†…å­˜æ¨¡å‹" class="headerlink" title="1. å†…å­˜æ¨¡å‹"></a>1. å†…å­˜æ¨¡å‹</h3><p>JVMä¸»è¦è§£å†³å„ä¸ªçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸ä¸»å­˜ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">graph TD;</span><br><span class="line">Thread-0-å·¥ä½œå†…å­˜ --&gt; ä¸€è‡´æ€§åè®®;</span><br><span class="line">Thread-1-å·¥ä½œå†…å­˜ --&gt; ä¸€è‡´æ€§åè®®;</span><br><span class="line">Thread-2-å·¥ä½œå†…å­˜ --&gt; ä¸€è‡´æ€§åè®®;</span><br><span class="line">ä¸€è‡´æ€§åè®® --&gt; ä¸»å­˜;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸€è‡´æ€§åè®®å…·ä½“å†…å®¹"><a href="#ä¸€è‡´æ€§åè®®å…·ä½“å†…å®¹" class="headerlink" title="ä¸€è‡´æ€§åè®®å…·ä½“å†…å®¹"></a>ä¸€è‡´æ€§åè®®å…·ä½“å†…å®¹</h4><ul>
<li>read - load: ä¸¤æ¡æŒ‡ä»¤å¿…é¡»æŒ‰<strong><em>é¡ºåº</em></strong>ä½¿ç”¨, ä¸”å¿…é¡»<strong><em>æˆå¯¹</em></strong>å‡ºç°, readä½œç”¨äº<strong>ä¸»å­˜</strong>, loadä½œç”¨äº<strong>å·¥ä½œå†…å­˜</strong>. ç›®çš„æ˜¯ä¸ºäº†æŠŠ<strong>ä¸»å­˜</strong>ä¸­çš„å˜é‡è¯»å…¥çº¿ç¨‹<strong>å·¥ä½œå†…å­˜</strong>å˜ä¸ºç§æœ‰å‰¯æœ¬.</li>
<li>store - write: ä¸¤æ¡æŒ‡ä»¤å¿…é¡»æŒ‰<strong><em>é¡ºåº</em></strong>ä½¿ç”¨, ä¸”å¿…é¡»<strong><em>æˆå¯¹</em></strong>å‡ºç°, storeä½œç”¨äº<strong>å·¥ä½œå†…å­˜</strong>, writeä½œç”¨äº<strong>ä¸»å­˜</strong>. ç›®çš„æ˜¯æŠŠ<strong>å·¥ä½œå†…å­˜</strong>ä¸­çš„æ”¾å…¥<strong>ä¸»å­˜</strong>.</li>
<li>use/assign:  ä½œç”¨äº<strong>å·¥ä½œå†…å­˜</strong>, å°†<strong>å·¥ä½œå†…å­˜</strong>ä¸­çš„æ•°æ®ä¼ è¾“ç»™æ‰§è¡Œå¼•æ“/å°†æ‰§è¡Œå¼•æ“å¾—åˆ°çš„ç»“æœèµ‹å€¼ç»™<strong>å·¥ä½œå†…å­˜</strong>.</li>
<li>lock/unlock: ä½œç”¨äº<strong>ä¸»å­˜</strong>, å°†ä¸€ä¸ªå˜é‡é”å®šğŸ”’/è§£é”ğŸ”“ä¸ºçº¿ç¨‹ç‹¬å çš„çŠ¶æ€. <ul>
<li>lockä¼šå¯¼è‡´<strong>å·¥ä½œå†…å­˜</strong>æ¸…ç©º, ä¸”éœ€è¦è¿›è¡Œload(ä¸»å­˜ç»™å‡º)æˆ–è€…assign(è®¡ç®—å¼•æ“ç»™å‡º)å¯¹å˜é‡è¿›è¡Œèµ‹å€¼.</li>
<li>ä¸€ä¸ªå˜é‡åªèƒ½åŒæ—¶è¢«ä¸€ä¸ªçº¿ç¨‹lock, ä½†æ˜¯ä¸€ä¸ªå˜é‡å¯ä»¥è¢«åŒä¸€ä¸ªçº¿ç¨‹lockå¤šæ¬¡, ä¸è¿‡å¿…é¡»æœ‰ç›¸åŒæ•°é‡çš„unlock.</li>
<li>unlockä¹‹å‰å¿…é¡»æœ‰store - write ä¸”ä¹‹å‰å¿…é¡»è¢«locké”å®š.</li>
</ul>
</li>
</ul>
<h4 id="volatile-å…³é”®å­—"><a href="#volatile-å…³é”®å­—" class="headerlink" title="volatile å…³é”®å­—"></a>volatile å…³é”®å­—</h4><p>æä¾›äº†æœ‰åºæ€§: ç¦æ­¢å†…å­˜é‡æ’åºä¼˜åŒ–*. </p>
<p>æä¾›äº†å¯è§æ€§: åŸç†æ˜¯ç›´æ¥å°†å¤„ç†æœºä¸­çš„Cacheæ— æ•ˆåŒ–, ä½¿å¾—æ‰€æœ‰çº¿ç¨‹ä¸å¾—ä¸ä»ä¸»å­˜é‡Œè¯»å–æ•°æ®.</p>
<p><strong>ä¸ä¿è¯åŸå­æ€§.</strong></p>
<h3 id="2-çº¿ç¨‹å®ç°"><a href="#2-çº¿ç¨‹å®ç°" class="headerlink" title="2. çº¿ç¨‹å®ç°"></a>2. çº¿ç¨‹å®ç°</h3><p>Threadå¯¹è±¡ä¸­çš„run()æ˜¯Threadå¯¹è±¡å°†æ‰§è¡Œä»£ç é€»è¾‘çš„éƒ¨åˆ†, è‹¥ç›´æ¥è°ƒç”¨åˆ™ä¸æ™®é€šçš„ä¸€ä¸ªå®ç°äº†run()æ–¹æ³•çš„ç±»æ— å·®åˆ«.</p>
<p>Threadå¯¹è±¡ä¸­çš„start()æ–¹æ³•ä½œç”¨æ˜¯å¤„ç†ä¸€å¥—è¿›ç¨‹å‡†å¤‡å·¥ä½œ(åŒ…æ‹¬è°ƒç”¨æœ¬åœ°ç³»ç»Ÿè°ƒç”¨åˆ›å»ºçº¿ç¨‹). çº¿ç¨‹åˆ›å»ºå®Œæ¯•å, å°†run()ä¸­å†™å¥½çš„ä»£ç æ³¨å…¥åˆ°è¯¥çº¿ç¨‹ä¸­æ‰§è¡Œè¯¥çº¿ç¨‹.</p>
<h3 id="3-çº¿ç¨‹å®‰å…¨"><a href="#3-çº¿ç¨‹å®‰å…¨" class="headerlink" title="3. çº¿ç¨‹å®‰å…¨"></a>3. çº¿ç¨‹å®‰å…¨</h3><p>å®šä¹‰: å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶, è‹¥ä¸è€ƒè™‘çº¿ç¨‹è°ƒåº¦, äº¤æ›¿, åŒæ­¥æ‰‹æ®µå’Œä»»ä½•åè°ƒæ“ä½œ, å•æ¬¡è°ƒç”¨è¯¥å¯¹è±¡å¯ä»¥è·å¾—æ­£ç¡®ç»“æœ, ç§°ä¹‹ä¸ºçº¿ç¨‹å®‰å…¨.</p>
<blockquote>
<p><strong>çº¿ç¨‹å®‰å…¨çš„ç±»å°±ä¸éœ€è¦æ·»åŠ åŒæ­¥æ‰‹æ®µäº†ä¹ˆ?</strong></p>
<p>éä¹Ÿ.</p>
<p>å¤§å¤šçº¿ç¨‹å®‰å…¨çš„å®¹å™¨éƒ½æ˜¯åœ¨æ–¹æ³•å¤„åŠ å…¥synchronizedå…³é”®å­—, è€Œéåœ¨å˜é‡å¤„.</p>
<p>è¿™å°±å¯¼è‡´ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„æ–¹æ³•å¯¹ç»Ÿä¸€å¯¹è±¡è¿›è¡Œä¿®æ”¹, ä»ç„¶ä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨.</p>
</blockquote>
<h4 id="å®ç°çº¿ç¨‹å®‰å…¨ç¼–ç¨‹"><a href="#å®ç°çº¿ç¨‹å®‰å…¨ç¼–ç¨‹" class="headerlink" title="å®ç°çº¿ç¨‹å®‰å…¨ç¼–ç¨‹"></a>å®ç°çº¿ç¨‹å®‰å…¨ç¼–ç¨‹</h4><blockquote>
<p>çº¿ç¨‹å®‰å…¨çš„ç›®çš„æ˜¯çº¿ç¨‹ä¹‹é—´å¿…é¡»è¦åŒæ­¥.</p>
</blockquote>
<p><strong>1.  æ— åŒæ­¥</strong></p>
<ul>
<li>ä½¿ç”¨<strong>çº¯ä»£ç (å¯é‡å…¥ä»£ç )</strong> , çº¯ä»£ç å…·æœ‰ä¸€äº›ç‰¹æ€§, ä¾‹å¦‚:    <ul>
<li>ä¸€äº›ä¸ä¾èµ–å…¨å±€å˜é‡,å…±äº«å˜é‡, ä¸å®ç”¨å…¬å…±èµ„æº, æ‰€ä»¥çŠ¶æ€é‡å‡ç”±å‚æ•°ä¼ å…¥.</li>
<li>ç»“æœæ˜¯å¯é¢„æµ‹çš„, ç›¸åŒçš„è¾“å…¥, ç»“æœä¹Ÿæ˜¯ç›¸åŒçš„.</li>
</ul>
</li>
<li>ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨TLS â€”â€” Thread Local Storage.</li>
</ul>
<p><strong>2. éé˜»å¡çš„åŒæ­¥</strong></p>
<blockquote>
<p> åˆ©ç”¨ Test-and-Set, CASç­‰ç¡¬ä»¶æŒ‡ä»¤, å®ç°çš„è½»é‡çº§é”,ä¹è§‚é”. </p>
</blockquote>
<p>å…¶æ€æƒ³æ˜¯: </p>
<ul>
<li>ç›´æ¥åœ¨CPUæ—¶é—´é‡Œæµ‹è¯•ç›®æ ‡æ˜¯å¦è¢«å¾ç”¨, è‹¥æ²¡æœ‰è¢«å¾ç”¨ç›´æ¥æ‰§è¡Œ.</li>
<li>è‹¥è¢«å¾ç”¨, åˆ™ç›´æ¥åœ¨CPUæ—¶é—´å†…ç­‰å¾…, ä¸å»é˜»å¡çº¿ç¨‹.é¿å…äº†é˜»å¡/å”¤é†’çš„çº¿ç¨‹åˆ‡æ¢å¼€é”€.</li>
</ul>
<p>Javaä¸­å¸¦æœ‰concrrentçš„ç±»å¸¸å¸¸ä½¿ç”¨æ­¤ç±»æ–¹æ³•è¿›è¡ŒåŒæ­¥.</p>
<p><strong>3. é˜»å¡çš„åŒæ­¥</strong></p>
<blockquote>
<p>ä½¿ç”¨synchronizedå’ŒReentrantLockç­‰å®ç°çš„é‡é‡çº§é”, æ‚²è§‚é”.</p>
</blockquote>
<p>åœ¨å†…æ ¸æ€, ç”¨æˆ·æ€ä¹‹é—´åˆ‡æ¢, ä»¥é˜»å¡/å”¤é†’çº¿ç¨‹.</p>
<h3 id="4-é”"><a href="#4-é”" class="headerlink" title="4. é”"></a>4. é”</h3><h4 id="4-1-å¯é‡å…¥é”-java-util-concurrent-locks-ReentrantLock-vs-synchronized-å…³é”®å­—"><a href="#4-1-å¯é‡å…¥é”-java-util-concurrent-locks-ReentrantLock-vs-synchronized-å…³é”®å­—" class="headerlink" title="4.1 å¯é‡å…¥é”  java.util.concurrent.locks.ReentrantLock vs. synchronized å…³é”®å­—"></a>4.1 å¯é‡å…¥é”  java.util.concurrent.locks.ReentrantLock vs. synchronized å…³é”®å­—</h4><blockquote>
<p>å¯é‡å…¥: æ˜¯æŒ‡è¢«ä¸­æ–­çš„å‡½æ•°åœ¨è°ƒåº¦å›æ¥ä¹‹åå¯ä»¥ç»§ç»­æ‰§è¡Œ.</p>
<p>ä¸å¯é‡å…¥: æ˜¯æŒ‡è¢«ä¸­æ–­åè¿”å›åçš„æ“ä½œå·²ç»å’Œä¸ä¸­æ–­çš„æƒ…å†µä¸ç­‰æ•ˆäº†. ä¾‹å¦‚å¯¹å…¬å…±å˜é‡è¿›è¡Œæ“ä½œ, çªç„¶è¢«ä¸­æ–­.</p>
</blockquote>
<p>å¯é‡å…¥é”: åŒä¸€ä¸ªçº¿ç¨‹å¯¹ä¸€æ®µä»£ç åŠ é”ä¹‹å, ä¸­æ–­åå¯å†æ¬¡è·å¾—è¯¥é”.</p>
<p>ReentrantLock ä¸ synchronizedçš„åŒºåˆ«åœ¨äº:</p>
<ul>
<li>å…¬å¹³é”æ–¹é¢: ReentrantLockå¯é€‰æ‹©ä¸ºå…¬å¹³é”æ¨¡å¼, è€Œsynchronizedåªèƒ½ä¸ºéå…¬å¹³é”.</li>
<li>ä»£ç æ–¹é¢: ReentrantLockåŠ é”è§£é”ä¸å—ä»£ç å—é™åˆ¶, å¯ä»¥åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­åŠ é”, å¦ä¸€ä¸ªæ–¹æ³•ä¸­è§£é”; synchronizedåªèƒ½é™åˆ¶åœ¨ä¸€ä¸ªä»£ç å—ä¸­.</li>
<li>ç­‰å¾…ä¸­æ–­æ–¹é¢: ReentrantLockå¯åœ¨çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾èµ„æºçš„æ—¶å€™, ç­‰å¾…èµ„æºçš„çº¿ç¨‹æ”¾å¼ƒç­‰å¾….</li>
<li>å”¤é†’æ¡ä»¶æ–¹é¢: ReentrantLockå¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶.</li>
</ul>
<p><strong>synchronized å®ç°åŸç†:</strong></p>
<p>åœ¨synchronizedåŒ…è£¹çš„ä»£ç å—çš„å‰åæ’å…¥ç®¡ç¨‹æŒ‡ä»¤.</p>
<p><strong>ReentrantLock å®ç°åŸç†: </strong></p>
<blockquote>
<p>æ•°æ®ç»“æ„: CLHé˜Ÿåˆ— â€”â€” ä¸€ä¸ªåŸºäºåŒå‘é“¾è¡¨çš„FIFOé˜Ÿåˆ—, å®ƒå’Œæ™®é€šçš„é˜Ÿåˆ—çš„åŒºåˆ«åœ¨äºåŠ å…¥äº†å¯¹é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ ‡è®°, ç”¨äºæ ‡è®°æ’é˜Ÿçº¿ç¨‹çš„çŠ¶æ€.</p>
<p>PROPAGATE èŠ‚ç‚¹: å”¤é†’å®ƒ, å®ƒè¿˜ä¼šä¼ æ’­å¼å”¤é†’å®ƒåé¢çš„èŠ‚ç‚¹, ç”¨äºå®ç°å…±äº«é”.</p>
<p>SIGNAL èŠ‚ç‚¹: ç­‰å¾…å‰æ–¹çš„èŠ‚ç‚¹å”¤é†’è‡ªå·±.</p>
<p>CONDITION èŠ‚ç‚¹: è¡¨ç¤ºæ’åºçº¿ç¨‹åœ¨<strong>æ¡ä»¶é˜Ÿåˆ—</strong>ä¸­.</p>
<p>CANCELLED èŠ‚ç‚¹: è¯¥çº¿ç¨‹è¢«å–æ¶ˆ.</p>
<p>0: æ–°è¿›çº¿ç¨‹çš„èŠ‚ç‚¹.</p>
</blockquote>
<ul>
<li>ReentrantLock ä½¿ç”¨ AbstractQueuedSynchronizer æ¥å­˜å‚¨ä¸¤ä¸ªé˜Ÿåˆ—: æ¡ä»¶é˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—.</li>
<li>æ¡ä»¶é˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—ä¸­å­˜æ”¾çš„éƒ½æ˜¯æ’é˜Ÿçš„çº¿ç¨‹.</li>
</ul>
<blockquote>
<p>æ¡ä»¶é˜Ÿåˆ—ä¸ç­‰å¾…é˜Ÿåˆ—çš„ä½œç”¨ç›¸ä¼¼, éƒ½æ˜¯å­˜æ”¾æ’é˜Ÿçš„çº¿ç¨‹. </p>
<p>åªæ˜¯ä¸€äº›æ¡ä»¶å”¤é†’çš„çº¿ç¨‹å°šæœªæ»¡è¶³æ¡ä»¶, éœ€è¦åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…, å½“æ»¡è¶³æ¡ä»¶å, å°†å…¶åŠ å…¥ç­‰å¾…é˜Ÿåˆ—, è¿›è¡Œç­‰å¾….</p>
<p>è¿›å…¥ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹, å°±å¼€å§‹ç­‰å¾…è·å–é”.</p>
</blockquote>
<p><strong>å…±äº«é”çš„å®ç°</strong></p>
<p>èŠ‚ç‚¹å¸¦PROPAGATEæ ‡å¿—æ’å…¥ç­‰å¾…é˜Ÿåˆ—, å½“è¯¥èŠ‚ç‚¹è¢«å”¤é†’, ä¼šä¼ æ’­å”¤é†’åç»­èŠ‚ç‚¹.</p>
<p><strong>å¯é‡å…¥çš„å®ç°</strong></p>
<p>æ£€æŸ¥è¯¥æŒæœ‰é”çš„çº¿ç¨‹æ˜¯ä¸æ˜¯å½“å‰çº¿ç¨‹, è‹¥æ˜¯åˆ™è¿”å›è¯¥é”.</p>
<p><strong>å…¬å¹³/éå…¬å¹³çš„å®ç°</strong></p>
<p>å…¬å¹³: å…ˆè¿›å…¥AQSæ’é˜Ÿ.</p>
<p>éå…¬å¹³é”: åŸºäºCASæ£€æµ‹å½“å‰æ˜¯å¦æœ‰çº¿ç¨‹æŒæœ‰é”, è‹¥æ²¡æœ‰, è¿›è€Œç›´æ¥æ’é˜Ÿ.</p>
<h4 id="4-2-è¯»å†™é”-Java-util-concurrent-locks-ReentrantReadWriteLock"><a href="#4-2-è¯»å†™é”-Java-util-concurrent-locks-ReentrantReadWriteLock" class="headerlink" title="4.2 è¯»å†™é” Java.util.concurrent.locks.ReentrantReadWriteLock"></a>4.2 è¯»å†™é” Java.util.concurrent.locks.ReentrantReadWriteLock</h4><ul>
<li>å¤šä¸ªè¯»æ“ä½œä¸ä¼šé˜»å¡.</li>
<li>ä¸€ä¸ªå†™æ“ä½œé˜»å¡æ‰€æœ‰è¯»æ“ä½œå’Œæ‰€æœ‰å†™æ“ä½œ.</li>
</ul>
<h4 id="4-3-è½»é‡é”"><a href="#4-3-è½»é‡é”" class="headerlink" title="4.3 è½»é‡é”"></a>4.3 è½»é‡é”</h4><ul>
<li>è‹¥æ£€æµ‹åˆ°æ— é”å®š, JVMç»™è¦åŠ é”çš„å¯¹è±¡åˆ›å»ºä¸€ä¸ªLock Record å­˜å‚¨å¯¹è±¡å¤´(Mark Word)çš„æ‹·è´.</li>
<li>JVMä½¿ç”¨CASæ“ä½œæ›´æ–°å¯¹è±¡å¤´è‡³Lock Recordè¯´æ˜è¯¥çº¿ç¨‹æŒæœ‰äº†è¿™ä¸ªé”.</li>
<li>è‹¥å¤±è´¥, è¯´æ˜å½“å‰æœ‰çº¿ç¨‹å ç”¨è¯¥å¯¹è±¡.</li>
<li>è§£é”ä»ä½¿ç”¨CASæ“ä½œ.</li>
</ul>
<blockquote>
<p>è½»é‡çº§é”åªé€‚åˆè‡³å¤š2ä¸ªçº¿ç¨‹çš„ç«äº‰, å¤šäº2ä¸ªå°†è†¨èƒ€ä¸ºé‡é‡çº§é”.</p>
</blockquote>
<h4 id="4-4-åå‘é”"><a href="#4-4-åå‘é”" class="headerlink" title="4.4 åå‘é”"></a>4.4 åå‘é”</h4><ul>
<li>è¯¥é”å°†åå‘äºç¬¬ä¸€ä¸ªè·å¾—ä»–çš„çº¿ç¨‹, è‹¥é”ä¸€ç›´æ²¡æœ‰å…¶ä»–çº¿ç¨‹è·å–, åˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹æ°¸ä¸åŒæ­¥, ç›´æ¥æ¶ˆé™¤åŒæ­¥.</li>
<li>é€‚ç”¨äºåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—.</li>
</ul>
<h4 id="4-5-è‡ªæ—‹é”"><a href="#4-5-è‡ªæ—‹é”" class="headerlink" title="4.5 è‡ªæ—‹é”"></a>4.5 è‡ªæ—‹é”</h4><p>è‡ªæ—‹é”: åœ¨å¯¹è±¡è¢«é”å®šçš„æ—¶å€™, è®©ä¸‹ä¸€ä¸ªè¯·æ±‚è€…ç¨ç­‰ä¸€ä¸‹ â€”â€” å³æ‰§è¡Œä¸€ä¸‹å¿™å¾ªç¯ä¸æ”¾å¼ƒCPU.</p>
<p>è‡ªé€‚åº”è‡ªæ—‹é”:  åˆ©ç”¨ç®—æ³•åˆ¤å®šæ˜¯å¦ä½¿ç”¨è‡ªæ—‹é”, æˆ–è€…å–æ¶ˆè‡ªæ—‹é”.</p>
<blockquote>
<p>ç®—æ³•æ€æƒ³:</p>
<p>å¦‚æœè¯¥çº¿ç¨‹åˆšåˆšæˆåŠŸè·å–åˆ°äº†è‡ªæ—‹é”, é‚£ä¹ˆæˆ‘ä»¬ç›¸ä¿¡ä»–è¿™æ¬¡ä¹Ÿèƒ½è·å¾—è‡ªæ—‹é”.</p>
<p>è‹¥è¯¥çº¿ç¨‹å¾ˆå°‘æˆåŠŸè·å¾—è‡ªæ—‹é”, é‚£ä¹ˆæˆ‘ä»¬å°±å–æ¶ˆè‡ªæ—‹é”.</p>
</blockquote>
<h4 id="4-6-é”æ¶ˆé™¤"><a href="#4-6-é”æ¶ˆé™¤" class="headerlink" title="4.6 é”æ¶ˆé™¤"></a>4.6 é”æ¶ˆé™¤</h4><p>ç¼–è¯‘å™¨è¿è¡Œæ—¶é€šè¿‡<strong>é€ƒé€¸åˆ†æ</strong>, åˆ¤å®šæ•°æ®ä¸ä¼šäº§ç”Ÿ<strong>çº¿ç¨‹é€ƒé€¸</strong>åè¿›è¡Œé”æ¶ˆé™¤.</p>
<h4 id="4-7-é”ç²—åŒ–"><a href="#4-7-é”ç²—åŒ–" class="headerlink" title="4.7 é”ç²—åŒ–"></a>4.7 é”ç²—åŒ–</h4><p>å°†è¿ç»­çš„å¤šä¸ªå¯¹åŒä¸€ä¸ªå¯¹è±¡çš„åŠ é”è§£é”æ“ä½œç²—åŒ–ä¸ºå¯¹ä¸€ä¸ªä»£ç å—çš„ä¸€æ¬¡æ€§åŠ é”è§£é”.</p>
<h4 id="4-8-å…¬å¹³é”-éå…¬å¹³é”"><a href="#4-8-å…¬å¹³é”-éå…¬å¹³é”" class="headerlink" title="4.8 å…¬å¹³é”/éå…¬å¹³é”"></a>4.8 å…¬å¹³é”/éå…¬å¹³é”</h4><blockquote>
<p>å®šä¹‰: </p>
<ul>
<li><p>å…¬å¹³é” â€”â€” æŒ‰ç…§è¯·æ±‚é”çš„æ’é˜Ÿé¡ºåºåˆ†å‘é”.</p>
</li>
<li><p>éå…¬å¹³é” â€”â€” éšæœºé€‰å–æ­£åœ¨ç­‰å¾…é”çš„çº¿ç¨‹, ç»™äºˆå…¶é”.</p>
</li>
</ul>
</blockquote>
<p>synchronized å…³é”®å­—æ˜¯éå…¬å¹³é”.</p>
<p>ReentrantLock é»˜è®¤éå…¬å¹³é”, ä½†æ˜¯å¯ä»¥è®¾ç½®ä¸ºå…¬å¹³é”.</p>
<h4 id="4-9-åŒé”æ£€æµ‹-DCL-Double-Check-Lock"><a href="#4-9-åŒé”æ£€æµ‹-DCL-Double-Check-Lock" class="headerlink" title="4.9 åŒé”æ£€æµ‹ DCL(Double Check Lock)"></a>4.9 åŒé”æ£€æµ‹ DCL(Double Check Lock)</h4><p>åŸç†:</p>
<ol>
<li>å…ˆæ£€æµ‹æ ‡å¿—, ç›¸å…³åˆ¤å®šæ¡ä»¶(ä¾‹å¦‚æŒæœ‰ä¸´ç•Œèµ„æºçš„æ—¶å€™æ”¾ç½®çš„æ ‡å¿—)</li>
<li>æ£€æµ‹æˆåŠŸ, åˆ™è¿›å…¥ä¸´ç•ŒåŒº, å¦åˆ™ä¸è¿›å…¥.</li>
</ol>
<p>ä¼˜ç‚¹:</p>
<ul>
<li>å¯ä»¥åœ¨æ¡ä»¶ä¸æˆç†Ÿçš„æ—¶å€™ä¸æŒæœ‰ä¸´ç•Œèµ„æº, å‡å°‘æ¶ˆè€—.</li>
</ul>
<p>ç¼ºç‚¹:</p>
<ul>
<li>æœªä½¿ç”¨<code>volatile</code> çš„æ ‡å¿—, ä¼šå¯¼è‡´ä»æŒ‡ä»¤é‡æ’åº, å¯¼è‡´çº¿ç¨‹ä¸å®‰å…¨. è§£å†³æ–¹æ³•å°±æ˜¯å¯¹éœ€è¦æ£€æµ‹çš„æ ‡è¯†è¿›è¡Œ<code>volatile</code>æ ‡è®°.</li>
</ul>
<h4 id="4-10-Atomicç±»çš„å®ç°åŸç†"><a href="#4-10-Atomicç±»çš„å®ç°åŸç†" class="headerlink" title="4.10 Atomicç±»çš„å®ç°åŸç†"></a>4.10 Atomicç±»çš„å®ç°åŸç†</h4><p><strong>CAS: check and swap</strong></p>
<p>åŸç†: ä¸€æ¡CPUæŒ‡ä»¤, å…·æœ‰åŸå­æ€§.</p>
<p>ç»™å‡ºä¸€ä¸ªæœŸæœ›å€¼, å†ç»™å‡ºä¸€ä¸ªè¦æ›¿æ¢å€¼.</p>
<p>è‹¥æµ‹è¯•ç›®æ ‡ç¬¦åˆæœŸæœ›å€¼, åˆ™å°†ç›®æ ‡çš„å€¼æ¢æˆè¦æ›¿æ¢çš„å€¼.</p>
<p><strong>volatile &amp; CAS</strong></p>
<ul>
<li><p>volatileä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§.</p>
</li>
<li><p>CASä¿è¯åŸå­æ€§.</p>
</li>
</ul>
<p>CASçš„ç¼ºç‚¹:</p>
<ol>
<li>ABAé—®é¢˜ â€”â€” æ·»åŠ ç‰ˆæœ¬å·å­—æ®µ, åˆ¤å®šæ—¶è¿˜è¦åˆ¤æ–­æ˜¯å¦ç‰ˆæœ¬ä¸€è‡´.</li>
<li>CPUå¾ªç¯å¼€é”€.</li>
<li>åªèƒ½æ“ä½œä¸€ä¸ªå˜é‡.</li>
</ol>
<h3 id="5-æœ‰åºæ€§-å¯è§æ€§-åŸå­æ€§"><a href="#5-æœ‰åºæ€§-å¯è§æ€§-åŸå­æ€§" class="headerlink" title="5. æœ‰åºæ€§, å¯è§æ€§, åŸå­æ€§"></a>5. æœ‰åºæ€§, å¯è§æ€§, åŸå­æ€§</h3><blockquote>
<p>å› ä¸ºæ²¡æœ‰åŸå­æ€§è€Œå¼•å‘å¹¶å‘é”™è¯¯çš„æ“ä½œåŒ…æ‹¬ä½†ä¸é™äº:</p>
<ul>
<li>check-then-act</li>
<li>read-modify-write</li>
</ul>
</blockquote>
<blockquote>
<p>é‡æ’åºæ˜¯æŒ‡CPUä¼šå°†æ— å…³çš„ä¸¤ä¸ªå˜é‡è°ƒåº, ä»¥è¾¾åˆ°æ›´é«˜çš„æ€§èƒ½. ä½†æ˜¯è¿™å¾€å¾€ä¼šå¯¼è‡´éæœŸæœ›çš„é¡ºåº.</p>
<p>ç¦æ­¢é‡æ’åºåˆ™æ˜¯å°†<strong>å†…å­˜å±éšœ</strong>æ’å…¥ä»£ç ä¸­, å°†é‡æ’åºç¦ç”¨.</p>
</blockquote>
<h4 id="5-1-volatitle"><a href="#5-1-volatitle" class="headerlink" title="5.1 volatitle"></a>5.1 volatitle</h4><p>volatileå…·æœ‰æœ‰åºæ€§: å†…å­˜å±éšœ; ä¹Ÿå…·æœ‰å¯è§æ€§: ä½¿å¾—Cacheå¤±æ•ˆ.</p>
<p>volatile å˜é‡çš„è¯»æ“ä½œçš„ç¡®å¾ˆæ¥è¿‘äºè¯»å–æ™®é€šå˜é‡çš„é€Ÿåº¦, ä½†æ˜¯å†™æ“ä½œéœ€è¦æ’å…¥å¤§é‡çš„å†…å­˜å±éšœ, ä¼šäº§ç”Ÿå¼€é”€.</p>
<p>ä½†å¤§å¤šæ•°åœºæ™¯æ€§èƒ½ä¼˜äºsynchronized.</p>
<h4 id="5-2-synchronized"><a href="#5-2-synchronized" class="headerlink" title="5.2 synchronized"></a>5.2 synchronized</h4><p>synchronizedå…·æœ‰: æœ‰åºæ€§, å¯è§æ€§, åŸå­æ€§.</p>
<h4 id="5-3-final"><a href="#5-3-final" class="headerlink" title="5.3 final"></a>5.3 final</h4><p>ä¸å¯å˜å¯¹è±¡çº¿ç¨‹å®‰å…¨.</p>
<h3 id="6-long-amp-double"><a href="#6-long-amp-double" class="headerlink" title="6. long&amp;double"></a>6. long&amp;double</h3><p>long &amp; double åœ¨ 32-bit JVM ä¸‹æ˜¯éåŸå­æ€§åè®®çš„, å› ä¸ºJVMå…è®¸2Byteçš„æ•°æ®ç±»å‹åˆ†ä¸¤æ¬¡è¯»å†™.</p>
<p>ä½†æ˜¯64-bit JVMä¸ä¼šå‡ºç°è¿™ç§éåŸå­åè®®çš„æƒ…å†µ.</p>
<h3 id="6-çº¿ç¨‹æ± "><a href="#6-çº¿ç¨‹æ± " class="headerlink" title="6. çº¿ç¨‹æ± "></a>6. çº¿ç¨‹æ± </h3><p><strong>çº¿ç¨‹æ± çš„ä½œç”¨:</strong> </p>
<ol>
<li>å‡å°‘é¢‘ç¹ç”³è¯·/é”€æ¯çº¿ç¨‹çš„èµ„æº.</li>
<li>å‡å°‘æ— é™åˆ¶ç”³è¯·å¸¦æ¥çš„æ¶ˆè€—èµ„æºçš„é£é™©.</li>
</ol>
<p><strong>ThreadPoolExecutorçš„æ€æƒ³:</strong></p>
<ul>
<li><p>é¦–å…ˆå°†ä»»åŠ¡å’Œçº¿ç¨‹åˆ†ç¦»,  ä»»åŠ¡æ”¾åœ¨é˜»å¡é˜Ÿåˆ—æˆ–è€…ç«‹å³æ‰§è¡Œ, çº¿ç¨‹æ”¾åœ¨çº¿ç¨‹æ± .</p>
</li>
<li><p>çº¿ç¨‹æ± å’Œä»»åŠ¡é˜Ÿåˆ—ç”¨ä¸€ä¸ªçº¿ç¨‹åˆ†é…å™¨è¡”æ¥.</p>
</li>
<li><p>çº¿ç¨‹åˆ†é…å™¨æ‹¿åˆ°ä»»åŠ¡åä»çº¿ç¨‹æ± ä¸­è·å–çº¿ç¨‹, ç„¶åå†ä»é˜»å¡é˜Ÿåˆ—ä¸­æ‹¿(ä¹Ÿå¯ä»¥é€‰å–éœ€è¦ç›´æ¥æ‰§è¡Œçš„ä»»åŠ¡) è¿›è¡Œæ‰§è¡Œ.</p>
</li>
<li><p>çº¿ç¨‹æ± éƒ¨åˆ†åˆ™è´Ÿè´£çº¿ç¨‹çš„åˆ›å»ºå’Œå›æ”¶, ä¸ä»»åŠ¡è§£è€¦.</p>
</li>
</ul>
<p><strong>ä»»åŠ¡è°ƒåº¦æ€æƒ³</strong></p>
<p>çº¿ç¨‹å°äºæ ¸å¿ƒæ•°, çº¿ç¨‹æ± æ­£åœ¨è¿è¡Œ, å³å¯æ‰§è¡Œ.</p>
<p>å¦åˆ™åŠ å…¥é˜»å¡é˜Ÿåˆ—, è‹¥é˜Ÿåˆ—æ»¡äº†, å°±æ‹’ç»ä»»åŠ¡.</p>
<p>çº¿ç¨‹æ± è¦æ˜¯æœªè¿è¡Œ, ä¹Ÿæ‹’ç»ä»»åŠ¡.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Callable&lt;V&gt;;<span class="comment">// å¸¦è¿”å›çš„, æŠ›å¼‚å¸¸çš„Runnable</span></span><br><span class="line">Future&lt;V&gt;;</span><br></pre></td></tr></table></figure>
<h3 id="çº¿ç¨‹åŒæ­¥"><a href="#çº¿ç¨‹åŒæ­¥" class="headerlink" title="çº¿ç¨‹åŒæ­¥"></a>çº¿ç¨‹åŒæ­¥</h3><h4 id="notify-notifyAll-wait"><a href="#notify-notifyAll-wait" class="headerlink" title="notify()/notifyAll() + wait()"></a>notify()/notifyAll() + wait()</h4><p>ç¼ºç‚¹: </p>
<ul>
<li>è¿‡æ—©å”¤é†’: å”¤é†’æ¡ä»¶æœªæˆç«‹çš„æƒ…å†µä¸‹, è¢«æå‰å”¤é†’.</li>
<li>ä¿¡å·ä¸¢å¤±: .wait()è¢«æš‚åœ(å…ˆnotify(), ä¹‹åæ‰wait()), å¯¼è‡´æ²¡æœ‰æ”¶åˆ°notifyè¿›è€Œå¯¼è‡´æ— é™ç­‰å¾….</li>
<li>æ¬ºéª—æ€§å”¤é†’: æ²¡æœ‰å…¶ä»–çº¿ç¨‹æ‰§è¡Œè€Œå¯¼è‡´å”¤é†’(å°æ¦‚ç‡).</li>
<li>notifyAll()å¯å¯¼è‡´å¤šä¸ªçº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢, å¼€é”€å¢å¤§.</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Object object = <span class="keyword">new</span> Object();</span><br><span class="line">AtomicBoolean flag = <span class="keyword">new</span> AtomicBoolean(<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            <span class="keyword">while</span>(flag.get())&#123; <span class="comment">//ä¿æŠ¤æ¡ä»¶</span></span><br><span class="line">                object.wait();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">" is awake."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (object) &#123;</span><br><span class="line">        System.out.println(<span class="string">"Prepare for notifying"</span>);</span><br><span class="line">        flag.getAndSet(<span class="keyword">false</span>);</span><br><span class="line">        object.notifyAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>
<h4 id="join"><a href="#join" class="headerlink" title="join()"></a>join()</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread th1 = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        th1.join();<span class="comment">//åç»­çº¿ç¨‹</span></span><br><span class="line">        System.out.println(<span class="string">"awake"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br><span class="line">th1.start();</span><br></pre></td></tr></table></figure>
<h4 id="Condition-æ¥å£"><a href="#Condition-æ¥å£" class="headerlink" title="Condition æ¥å£"></a>Condition æ¥å£</h4><blockquote>
<p>å¯ä»¥è§£å†³è¿‡æ—©å”¤é†’çš„é—®é¢˜.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> Lock lock = <span class="keyword">new</span> ReentrantLock(); <span class="comment">//ä¸å¯å˜å¯¹è±¡å¯ä»¥é¿å…è®¸å¤šé—®é¢˜</span></span><br><span class="line"><span class="keyword">final</span> Condition condition = lock.newCondition(); <span class="comment">//Conditionç”±lockç»™å‡º</span></span><br><span class="line">AtomicBoolean flag = <span class="keyword">new</span> AtomicBoolean(<span class="keyword">true</span>);</span><br><span class="line">Runnable runnable = ()-&gt;&#123;</span><br><span class="line">    lock.lock(); <span class="comment">//ä½¿ç”¨conditionä¹‹å‰è¦ä¸Šé”, ä»¥é˜²æ¬ºéª—æ€§å”¤é†’, æå‰å”¤é†’, ä¿¡å·ä¸¢å¤±</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">while</span>(flag.get()) &#123;</span><br><span class="line">            condition.await();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(Thread.currentThread().getName() + <span class="string">" is awake"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Thread(runnable).start();</span><br><span class="line"><span class="keyword">new</span> Thread(runnable).start();</span><br><span class="line"><span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">    lock.lock(); <span class="comment">//ä½¿ç”¨conditionä¹‹å‰è¦ä¸Šé”</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        flag.set(<span class="keyword">false</span>);</span><br><span class="line">        condition.signalAll();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">       lock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>
<h4 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> CountDownLatch countDownLatch = <span class="keyword">new</span> CountDownLatch(<span class="number">3</span>);</span><br><span class="line">Runnable runnable = () -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">        System.out.println(countDownLatch.getCount());</span><br><span class="line">        countDownLatch.countDown();</span><br><span class="line">        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">IntStream.range(<span class="number">0</span>,<span class="number">10</span>).forEach(i -&gt; &#123;  <span class="comment">// è¿‡å¤šçš„countDown åªä¼šè®© countæ°¸è¿œå‘†åœ¨0</span></span><br><span class="line">    <span class="keyword">new</span> Thread(runnable).start();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        countDownLatch.await();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">"finish"</span>);</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>
<h4 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h4><blockquote>
<p>åŸç†:</p>
<ul>
<li>çº¿ç¨‹é—´é˜»å¡ä½¿ç”¨ReentrantLock</li>
<li>çº¿ç¨‹é—´åŒæ­¥ä½¿ç”¨Condition</li>
</ul>
</blockquote>
<p>ç”¨æ³•:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runable lastRunnable = () -&gt; &#123;...&#125;;</span><br><span class="line"><span class="keyword">final</span> CyclicBarrier cyclicBarrier = <span class="keyword">new</span> CyclicBarrier(n, lastRunnable); <span class="comment">// n=è°ƒç”¨.await()çš„çº¿ç¨‹ä¸ªæ•°</span></span><br><span class="line">Runable invokeAwaitRunnable = () -&gt; &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  cyclicBarrier.await();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> Thread(invokeAwaitRunnable).start();<span class="comment">//await()çš„è°ƒç”¨æ•°é‡è¾¾åˆ°n, åˆ™cyclicBarrierè‡ªåŠ¨å¯åŠ¨lastRunnable, æ— éœ€new Thread(lastRunnable).start();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®€å•åŒæ­¥:</span></span><br><span class="line"><span class="keyword">final</span> CyclicBarrier cyclicBarrierSimple = <span class="keyword">new</span> CyclicBarrier(n); </span><br><span class="line">Runnable run = ()-&gt; &#123;</span><br><span class="line">  <span class="comment">//æ‰€æœ‰çº¿ç¨‹éƒ½è°ƒç”¨await(), åœ¨cyclicBarrierSimpleè€—å°½ä¹‹å‰å‡é˜»å¡, cyclicBarrierSimpleä¸€æ—¦è€—å°½, åˆ™æ‰€æœ‰è°ƒç”¨await()çš„çº¿ç¨‹å‡å”¤é†’.</span></span><br><span class="line">  cyclicBarrierSimple.await(); </span><br><span class="line">&#125;</span><br><span class="line">IntStream.range(<span class="number">0</span>,n).forEach(i -&gt; <span class="keyword">new</span> Thread(run).start());</span><br></pre></td></tr></table></figure>
<h2 id="V-å¹¶å‘å®¹å™¨"><a href="#V-å¹¶å‘å®¹å™¨" class="headerlink" title="V å¹¶å‘å®¹å™¨"></a>V å¹¶å‘å®¹å™¨</h2><h3 id="J-U-C-CopyOnWriteç³»åˆ—å®¹å™¨-vs-Collections-synchronizedCollection"><a href="#J-U-C-CopyOnWriteç³»åˆ—å®¹å™¨-vs-Collections-synchronizedCollection" class="headerlink" title="J.U.C.CopyOnWriteç³»åˆ—å®¹å™¨ vs. Collections.synchronizedCollection"></a>J.U.C.CopyOnWriteç³»åˆ—å®¹å™¨ vs. Collections.synchronizedCollection</h3><blockquote>
<ul>
<li><code>java.util.concurrent.CopyOnWriteArrayList</code> vs. <code>Collections.synchronizedList</code></li>
<li><code>java.util.concurrent.CopyOnWriteArraySet</code> vs. <code>Collections.synchronizedSet</code> </li>
</ul>
</blockquote>
<ul>
<li>CopyOnWrite å†™å¾—æ…¢(æ¯æ¬¡éƒ½æ˜¯å¤åˆ¶), è¯»å¾—å¿«, ä½†è¯»çš„æ˜¯å¿«ç…§, å®æ—¶æ€§å·®.</li>
<li>synchronizedCollection è¯´æœ‰æ“ä½œå‡åŠ é”, ç›¸æ¯”äºCopyOnWriteç³»åˆ—å®¹å™¨è¯»å¾—æ…¢, ä½†å†™å¾—å¿«, ä¸”å®æ—¶æ€§å¾ˆå¼º.</li>
</ul>
<h3 id="J-U-C-ConcurrentHashMap-vs-Hashtable-vs-Collections-synchronizedMap"><a href="#J-U-C-ConcurrentHashMap-vs-Hashtable-vs-Collections-synchronizedMap" class="headerlink" title="J.U.C.ConcurrentHashMap vs. Hashtable vs.  Collections.synchronizedMap"></a>J.U.C.ConcurrentHashMap vs. Hashtable vs.  Collections.synchronizedMap</h3><ul>
<li>ConcurrentHashMap: å°†tableåˆ†åŒº, å¯¹æŸäº›éœ€è¦çš„åŒºåŸŸè¿›è¡ŒåŠ é”.</li>
<li>Hashtable: å°†æ•´ä¸ªtableå…¨éƒ¨åŠ é”.</li>
<li>synchronizedMap: å¯¹æ‰€æœ‰æ“ä½œè¿›è¡ŒåŠ é”.</li>
</ul>
<h3 id="é˜»å¡é˜Ÿåˆ—-vs-å¹¶å‘é˜Ÿåˆ—-ArrayBlockingQueue-vs-ConcurrentLinkedQueue-vs-LinkedBlockingQueue"><a href="#é˜»å¡é˜Ÿåˆ—-vs-å¹¶å‘é˜Ÿåˆ—-ArrayBlockingQueue-vs-ConcurrentLinkedQueue-vs-LinkedBlockingQueue" class="headerlink" title="é˜»å¡é˜Ÿåˆ— vs. å¹¶å‘é˜Ÿåˆ—: ArrayBlockingQueue vs. ConcurrentLinkedQueue vs. LinkedBlockingQueue"></a>é˜»å¡é˜Ÿåˆ— vs. å¹¶å‘é˜Ÿåˆ—: ArrayBlockingQueue vs. ConcurrentLinkedQueue vs. LinkedBlockingQueue</h3><blockquote>
<ul>
<li><code>java.util.concurrent.ArrayBlockingQueue</code></li>
<li><code>java.util.concurrent.ConcurrentLinkedQueue</code></li>
<li><code>java.util.concurrent.LinkedBlockingQueue</code></li>
</ul>
</blockquote>
<ul>
<li>ArrayBlockingQueue: ä½¿ç”¨é” + æ•°ç»„.</li>
<li>ConcurrentLinkedQueue: ä½¿ç”¨CAS + é“¾è¡¨.</li>
<li>LinkedBlockingQueue: ä½¿ç”¨é” + é“¾è¡¨</li>
</ul>
<blockquote>
<p> <strong>J.U.C.SynchronousQueue</strong>  â€”â€” åŒæ­¥é˜Ÿåˆ—</p>
<p> å¹¶ä¸æ˜¯ä¸€ä¸ªå®é™…å¯ç”¨äºå­˜å‚¨çš„é˜Ÿåˆ—, å®ƒæ˜¯åŒæ­¥é˜Ÿåˆ—, ç”¨äºåŒæ­¥ç”Ÿäº§è€…æ¶ˆè´¹è€….</p>
<p> <code>SynchronousQueue</code>æœ¬èº«æ— å®¹é‡, æ‰€æœ‰pull()è¿›å»çš„å¯¹è±¡æ‰€åœ¨çš„çº¿ç¨‹éƒ½ä¼šé˜»å¡, take()ä¼šæ¢å¤è¢«é˜»å¡çš„çº¿ç¨‹.</p>
<p> ç±»ä¼¼äºPVæ“ä½œ.</p>
</blockquote>
<h2 id="VI-ç¨‹åºç¼–è¯‘"><a href="#VI-ç¨‹åºç¼–è¯‘" class="headerlink" title="VI ç¨‹åºç¼–è¯‘"></a>VI ç¨‹åºç¼–è¯‘</h2><h3 id="1-å‰ç«¯-Javaè¯­æ³•ç³–"><a href="#1-å‰ç«¯-Javaè¯­æ³•ç³–" class="headerlink" title="1. å‰ç«¯:  Javaè¯­æ³•ç³–"></a>1. å‰ç«¯:  Javaè¯­æ³•ç³–</h3><h3 id="æ³›å‹ç³»ç»Ÿ"><a href="#æ³›å‹ç³»ç»Ÿ" class="headerlink" title="æ³›å‹ç³»ç»Ÿ"></a>æ³›å‹ç³»ç»Ÿ</h3><blockquote>
<p> Javaæ³›å‹æ˜¯è¯­æ³•ç³–, ç”Ÿæˆä»£ç æ—¶, ä¼šç±»å‹æ“¦é™¤, å˜æˆè£¸ç±»å‹.</p>
</blockquote>
<h4 id="1-æ³›å‹ç†è®º-åå˜-é€†å˜-ä¸å˜"><a href="#1-æ³›å‹ç†è®º-åå˜-é€†å˜-ä¸å˜" class="headerlink" title="1. æ³›å‹ç†è®º: åå˜, é€†å˜, ä¸å˜"></a>1. æ³›å‹ç†è®º: åå˜, é€†å˜, ä¸å˜</h4><blockquote>
<p>å®šä¹‰: </p>
<ul>
<li>è‹¥ child <strong>extends</strong> parent, ä¸” f(child) ä¹Ÿæ˜¯ f(parent)çš„æ´¾ç”Ÿ, ç§° f()ä¸º<strong>åå˜</strong>.</li>
<li>è‹¥ child <strong>extends</strong> parent, è€Œ f(parent) æ˜¯f(child) çš„æ´¾ç”Ÿ, ç§°f()ä¸º<strong>é€†å˜</strong>.</li>
<li>è‹¥child <strong>extends</strong> parent, è€Œf(parent) å’Œf(child)æ— æ´¾ç”Ÿå…³ç³», ç§°ä¸º<strong>ä¸å˜</strong>.</li>
</ul>
</blockquote>
<p>åå˜çš„æ ¸å¿ƒåŸç†æ˜¯<strong>å­ç±»å‹å¯ä»¥éšå¼è½¬åŒ–ä¸ºçˆ¶ç±»å‹</strong>.</p>
<p>ä¾‹å¦‚ <code>Child extends Parent</code>ä¸”<code>List&lt;Child&gt; extends List&lt;Parent&gt;</code> , æˆ‘ä»¬ç§°<code>List&lt;&gt;</code>æ˜¯åå˜çš„.</p>
<p>è¯•æƒ³ä¸€ä¸‹:</p>
<p><code>childList = [ch0, ch1, ch2, ...]</code> , å½“<code>parentList = childList</code> çš„æ—¶å€™, å…¶å†…éƒ¨<code>[p0 = (parent)ch0, p1 = (parent)ch1, ...]</code> å¾ˆç¬¦åˆæƒ…ç†.</p>
<p>ç„¶è€Œ, Javaæ³›å‹æ˜¯åŸºäºç±»å‹æ“¦é™¤çš„æ³›å‹, ç¼–è¯‘ä¹‹åæ‰€æœ‰ç±»å‹å‡æ“¦é™¤ä¸ºè£¸ç±»å‹, æ‰€ä»¥Javaçš„æ³›å‹ç³»ç»Ÿæ˜¯<strong>ä¸å˜</strong>çš„.</p>
<p>å…·ä½“çš„:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Child&gt; <span class="comment">//  ç±»å‹æ“¦é™¤ --&gt; List</span></span><br><span class="line">List&lt;Parent&gt; <span class="comment">// ç±»å‹æ“¦é™¤ --&gt; List</span></span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘åå‡æ˜¯<code>List</code> è¿™ä¸ªè£¸ç±»å‹, å› ä¸ºåŒä¸º<code>List</code>ç±», å…¶ä¹‹é—´ä¸å­˜åœ¨<code>extends</code> æˆ–è€… <code>super</code> å…³ç³», æ‰€ä»¥æ˜¯<strong>ä¸å˜</strong>.</p>
<h4 id="2-æ³›å‹ç¬¦å·-å’Œ-Tçš„åŒºåˆ«"><a href="#2-æ³›å‹ç¬¦å·-å’Œ-Tçš„åŒºåˆ«" class="headerlink" title="2. æ³›å‹ç¬¦å·: ? å’Œ Tçš„åŒºåˆ«"></a>2. æ³›å‹ç¬¦å·: ? å’Œ Tçš„åŒºåˆ«</h4><p>T , K, Vç­‰å­—æ¯: åœ¨<strong>å®šä¹‰æ³›å‹ç±»å‹</strong>çš„æ—¶å€™ä½¿ç”¨, å®šä¹‰ååœ¨åç»­çš„ä»£ç å—ä¸­ä½¿ç”¨.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassA</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> T t;</span><br><span class="line">  <span class="function">T <span class="title">getT</span><span class="params">()</span> </span>&#123; ... &#125;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(T t)</span></span>&#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–è€…å‡½æ•°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span>&lt;T extends Comparable&gt; <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">(T t)</span></span>&#123; ... &#125;</span><br></pre></td></tr></table></figure>
<p>? é€šé…ç¬¦: åœ¨<strong>ä½¿ç”¨æ³›å‹å¯¹è±¡</strong>çš„æ—¶å€™ä½¿ç”¨, é™å®šæ³›å‹èŒƒå›´.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¾‹å¦‚, List&lt;T&gt; æ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰å¥½çš„æ³›å‹ç±»å‹, æ˜¯ä¸€ä¸ªæ³›å‹å®¹å™¨.</span></span><br><span class="line"><span class="keyword">public</span> App&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copy</span><span class="params">(List&lt;? <span class="keyword">super</span> Animal&gt; dst, List&lt;? extends Animal&gt; src)</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šé…ç¬¦æŒ‡ä»£:</p>
<p>è‹¥å­˜åœ¨å…³ç³»</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">Object &lt;-- Animal</span><br><span class="line">Animal &lt;-- Wolf</span><br><span class="line">Wolf &lt;-- Dog</span><br><span class="line">Dog &lt;-- Husky</span><br><span class="line">Dog &lt;-- Alaskan</span><br><span class="line">Dog &lt;-- Samoyed</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆ</p>
<ul>
<li><p><code>? extends Dog</code> æŒ‡ä»£çš„ç±»å‹æ˜¯: Husky, Alaskan, Samoyedä»¥åŠDogè‡ªå·±.</p>
</li>
<li><p><code>? super Dog</code> æŒ‡ä»£çš„ç±»å‹æ˜¯: Object, Animal, Wolf ä»¥åŠDogè‡ªå·±.</p>
</li>
</ul>
<p>ç”¨é€”:</p>
<ul>
<li><code>? extends Dog</code> ä¹Ÿç§°ç”Ÿäº§ç±»å‹. åœ¨æ•°æ®æ‹·è´çš„æ—¶å€™, å±äºç”Ÿäº§æ–¹.</li>
<li><code>? super Dog</code> ä¹Ÿç§°æ¶ˆè´¹ç±»å‹. åœ¨æ•°æ®æ‹·è´çš„æ—¶å€™, æ•°æ®æ¶ˆè€—æ–¹.</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> App&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copy</span><span class="params">(List&lt;? <span class="keyword">super</span> Dog&gt; dst, List&lt;? extends Dog&gt; src)</span></span>&#123;</span><br><span class="line">    <span class="comment">// ä»å­ç±»æ‹·è´æ•°æ®åˆ°çˆ¶ç±», å¯ä»¥ä¿è¯ç±»å‹è½¬æ¢åˆ°å®‰å…¨.</span></span><br><span class="line">    src.forEach(dst::add);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-åç«¯-JIT-ç¼–è¯‘ä¼˜åŒ–"><a href="#2-åç«¯-JIT-ç¼–è¯‘ä¼˜åŒ–" class="headerlink" title="2. åç«¯: JIT, ç¼–è¯‘ä¼˜åŒ–"></a>2. åç«¯: JIT, ç¼–è¯‘ä¼˜åŒ–</h3><p><strong>é€ƒé€¸åˆ†æ</strong></p>
<p>æ ˆä¸Šåˆ†é…: æ— çº¿ç¨‹é€ƒé€¸, å°†å †ä¸­çš„å¯¹è±¡æ”¾å…¥æ ˆä¸­.</p>
<p>æ ‡é‡æ›¿æ¢: æ— æ–¹æ³•é€ƒé€¸, å°†ç¬¦åˆå¯¹è±¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªåŸºæœ¬ç±»å‹.</p>
<h2 id="VII-Java-NIO"><a href="#VII-Java-NIO" class="headerlink" title="VII Java NIO"></a>VII Java NIO</h2><table>
<thead>
<tr>
<th>I/Oæ¨¡å‹</th>
<th>åŸç†</th>
<th>ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>BlockingI/O</td>
<td>æ•°æ®ç­‰å¾…ã€æ•°æ®ä¼ è¾“æ—¶å‡è¢«é˜»å¡.</td>
<td>ç›´æ¥é˜»å¡è¿›ç¨‹</td>
</tr>
<tr>
<td>non-Block I/O</td>
<td>ç”¨æˆ·è¿›ç¨‹å¾ªç¯è¯¢é—®Kernel; è¯·æ±‚åç›´æ¥å¾—åˆ°ç»“æœ:æ•°æ®æˆ–è€…é”™è¯¯.</td>
<td>è½®è¯¢æ¶ˆè€—CPUèµ„æº</td>
</tr>
<tr>
<td>å¤šè·¯å¤ç”¨</td>
<td>å¤šä¸ªI/Oæ³¨å†Œåˆ°åŒä¸€ä¸ªå¤ç”¨å™¨ä¸Š, è‹¥æ— å¯è¯»çš„æ•°æ®è¿›ç¨‹é˜»å¡;  è‹¥æœ‰å¯ç”¨æ•°æ®åˆ™å”¤é†’è¿›ç¨‹è¿›è¡Œè¯»å–.<br>è¢«selectå‡½æ•°é˜»å¡, è€Œä¸æ˜¯è¢«Socket I/Oé˜»å¡.</td>
<td>å®ç°éš¾åº¦å¤§</td>
</tr>
<tr>
<td>AIO</td>
<td>åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨epoll, å†…æ ¸å‡†å¤‡å®Œæˆåé€šçŸ¥è¿›ç¨‹, å®ç°çœŸæ­£çš„å¼‚æ­¥IO.</td>
<td>å®ç°éš¾åº¦å¤§</td>
</tr>
</tbody>
</table>
<h3 id="java-nio-ByteBuffer"><a href="#java-nio-ByteBuffer" class="headerlink" title="java.nio.ByteBuffer"></a>java.nio.ByteBuffer</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">flip(); <span class="comment">//ä¿ç•™limitåˆ°ä¸Šæ¬¡çš„ä½ç½®, positionå½’é›¶, ç”¨äºè¯»ä¹‹å‰.</span></span><br><span class="line">clear(); <span class="comment">//å…¨éƒ¨å½’é›¶, limit=capacity</span></span><br><span class="line">rewind();<span class="comment">//limit, positionå½’é›¶, ç”¨äºé‡å†™ä¹‹å‰.</span></span><br></pre></td></tr></table></figure>
<h3 id="java-nio-channels"><a href="#java-nio-channels" class="headerlink" title="java.nio.channels.*"></a>java.nio.channels.*</h3><h2 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h2><h3 id="HashMap-åŸç†"><a href="#HashMap-åŸç†" class="headerlink" title="HashMap åŸç†"></a>HashMap åŸç†</h3><p><strong>å­˜å‚¨åŸç†</strong></p>
<ul>
<li>HashMapç”±ä¸€ä¸ªæ•°ç»„ç»„æˆ, ä½¿ç”¨æ‹‰é“¾æ³•è¿›è¡Œå­˜å‚¨.</li>
<li>å½“æŸä¸ªæ¡¶ä¸­èŠ‚ç‚¹å¤§äºç­‰äº8ä¸ª, é“¾è¡¨åŒ–ä¸ºçº¢é»‘æ ‘.</li>
<li>å½“æŸä¸ªæ¡¶ä¸­èŠ‚ç‚¹å°äºç­‰äº6ä¸ªæ—¶, çº¢é»‘æ ‘åŒ–ä¸ºé“¾è¡¨.</li>
</ul>
<blockquote>
<blockquote>
<p><strong>å¤§äºç­‰äº8ä¸ªå…ƒç´ æ—¶, ä¸ºä»€ä¹ˆè¦åŒ–ä¸ºçº¢é»‘æ ‘?</strong></p>
<p>å…ƒç´ è¿‡å¤š, æ ‘å½¢æ•°æ®ç»“æ„çš„æœç´¢é€Ÿåº¦æ˜¯$O(\lg n)$ è€Œçº¿æ€§ç»“æ„æ˜¯$O(n)$ .</p>
<p>æ‰€ä»¥åº”è¯¥ä½¿ç”¨BSTä¹‹ç±»çš„æ ‘, ä¾‹å¦‚AVL, çº¢é»‘æ ‘.</p>
</blockquote>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘è¿™ä¸ªç»“æ„?</strong> </p>
<p>çº¢é»‘æ ‘ç­‰ä»·äº4é˜¶Bæ ‘, åœ¨å¤±è¡¡çš„æ—¶å€™, å…¶ç­‰ä»·äºBæ ‘2ã€3é˜¶çš„èŠ‚ç‚¹å¸æ”¶äº†å¤±è¡¡, ç›¸æ¯”äºAVLå‡å°‘äº†æ—‹è½¬æ¬¡æ•°.</p>
</blockquote>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆåŒ–ä¸ºæ ‘çš„é˜ˆå€¼æ˜¯8</strong>? </p>
<ul>
<li>TreeNodeså ç”¨ç©ºé—´æ˜¯æ™®é€šNodesçš„ä¸¤å€, è¿‡æ—©çš„åŒ–ä¸ºæ ‘, ç©ºé—´ä»£ä»·è¿‡é«˜;è¿‡æ™šçš„åŒ–ä¸ºæ ‘, æœç´¢çš„æ—¶é—´ä»£ä»·è¿‡é«˜.</li>
<li>ç†æƒ³æƒ…å†µä¸‹éšæœºhashCodeç®—æ³•ä¸‹æ‰€æœ‰æ¡¶ä¸­èŠ‚ç‚¹çš„åˆ†å¸ƒé¢‘ç‡ä¼šéµå¾ª<strong>æ³Šæ¾åˆ†å¸ƒ</strong>, å½“æŸä¸ªèŠ‚ç‚¹å¤§äº8çš„æ—¶å€™, å…¶æ¦‚ç‡ä¸º100ä¸‡åˆ†ä¹‹6. <a href="https://www.javazhiyin.com/34651.html" target="_blank" rel="noopener">*æ³¨</a> </li>
</ul>
</blockquote>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆåŒ–ä¸ºé“¾è¡¨çš„é˜ˆå€¼æ˜¯6?</strong></p>
<p>å› ä¸ºåœ¨8ä¸ªèŠ‚ç‚¹å·¦å³åå¤æ’å…¥åˆ é™¤, ä¼šå¯¼è‡´åå¤çš„é“¾è¡¨å’Œæ ‘çš„è½¬åŒ–, å¼•èµ·æ³¢åŠ¨.</p>
</blockquote>
</blockquote>
<h3 id="åå°„çš„ä»£ä»·"><a href="#åå°„çš„ä»£ä»·" class="headerlink" title="åå°„çš„ä»£ä»·"></a>åå°„çš„ä»£ä»·</h3><ul>
<li>æ£€æŸ¥æ–¹æ³•å¯è§æ€§</li>
<li>æ ¡éªŒå‚æ•°</li>
<li>JITæ— æ³•ä¼˜åŒ–</li>
</ul>
<h4 id="å°†étry-withçš„å¯¹è±¡å°è£…æˆå¯try-withçš„å¯¹è±¡"><a href="#å°†étry-withçš„å¯¹è±¡å°è£…æˆå¯try-withçš„å¯¹è±¡" class="headerlink" title="å°†étry-withçš„å¯¹è±¡å°è£…æˆå¯try-withçš„å¯¹è±¡"></a>å°†étry-withçš„å¯¹è±¡å°è£…æˆå¯try-withçš„å¯¹è±¡</h4><ul>
<li>å®ç°AutoCloseableæ¥å£</li>
</ul>
<h3 id="çº¿ç¨‹å¼‚å¸¸æ•è·-â€”â€”-UncaughtExceptionHandler"><a href="#çº¿ç¨‹å¼‚å¸¸æ•è·-â€”â€”-UncaughtExceptionHandler" class="headerlink" title="çº¿ç¨‹å¼‚å¸¸æ•è· â€”â€” UncaughtExceptionHandler"></a>çº¿ç¨‹å¼‚å¸¸æ•è· â€”â€” UncaughtExceptionHandler</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Thread.setDefaultUncaughtExceptionHandler((Thread t, Throwable e) -&gt;&#123;</span><br><span class="line">		System.err.println(t.getName() + <span class="string">" "</span> + e);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å†™å•ä¾‹éœ€è¦è€ƒè™‘çš„"><a href="#å†™å•ä¾‹éœ€è¦è€ƒè™‘çš„" class="headerlink" title="å†™å•ä¾‹éœ€è¦è€ƒè™‘çš„"></a>å†™å•ä¾‹éœ€è¦è€ƒè™‘çš„</h3><ul>
<li>åˆå§‹åŒ–çš„çº¿ç¨‹å®‰å…¨.</li>
<li>åå°„å¹²æ¶‰å†…éƒ¨æˆå‘˜çš„åˆå§‹åŒ–.</li>
<li>åºåˆ—åŒ–å¸¦æ¥çš„é—®é¢˜.</li>
<li>æ•ˆç‡.</li>
</ul>
<h4 id="è§£å†³çº¿ç¨‹å®‰å…¨-amp-åå°„-amp-åºåˆ—åŒ–"><a href="#è§£å†³çº¿ç¨‹å®‰å…¨-amp-åå°„-amp-åºåˆ—åŒ–" class="headerlink" title="è§£å†³çº¿ç¨‹å®‰å…¨ &amp; åå°„ &amp; åºåˆ—åŒ–"></a>è§£å†³çº¿ç¨‹å®‰å…¨ &amp; åå°„ &amp; åºåˆ—åŒ–</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SignletonClass</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">SignletonClass</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(DataHolder.LAZY != <span class="keyword">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Error"</span>); <span class="comment">//è§£å†³åå°„</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> SignletonClass <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> InstanceHolder.LAZY;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//è§£å†³çº¿ç¨‹å®‰å…¨: å†…éƒ¨ç±»ä¸€å®šä¼šåœ¨getInstance()è°ƒç”¨ä¹‹å‰åˆå§‹åŒ–, é¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜.</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InstanceHolder</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SignletonClass LAZY = <span class="keyword">new</span> SignletonClass(); </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span></span>&#123; <span class="comment">//é‡å†™readResolve()è§£å†³åºåˆ—åŒ–</span></span><br><span class="line">    <span class="keyword">return</span> SignletonClass.getInstance();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æšä¸¾å¼å•ä¾‹"><a href="#æšä¸¾å¼å•ä¾‹" class="headerlink" title="æšä¸¾å¼å•ä¾‹"></a>æšä¸¾å¼å•ä¾‹</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> EnumSingleton&#123; <span class="comment">// æšä¸¾ç±»è‡ªå¸¦å±è”½åå°„, åºåˆ—åŒ–, å…¶åˆå§‹åŒ–ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„, æ•ˆç‡ä¹Ÿé«˜.</span></span><br><span class="line">  INSTANCE;</span><br><span class="line">  <span class="keyword">private</span> Object data;</span><br><span class="line">  <span class="comment">//getter &amp; setter..</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> EnumSingleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> INSTANCE;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å®¹å™¨å•ä¾‹æ¨¡å¼"><a href="#å®¹å™¨å•ä¾‹æ¨¡å¼" class="headerlink" title="å®¹å™¨å•ä¾‹æ¨¡å¼"></a>å®¹å™¨å•ä¾‹æ¨¡å¼</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContainerSingleton</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">ContainerSingleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Object&gt; ioc = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String className)</span></span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(ioc)&#123;</span><br><span class="line">      <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="String-vs-StringBuffer-vs-StringBuilder"><a href="#String-vs-StringBuffer-vs-StringBuilder" class="headerlink" title="String vs. StringBuffer vs. StringBuilder"></a>String vs. StringBuffer vs. StringBuilder</h3><ul>
<li>StringBufferå’ŒStringBuilderåœ¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ—¶å€™å‡ä¸ä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡, ç”¨æ³•å¤§ä½“ç›¸åŒ, åªæ˜¯å‰è€…çº¿ç¨‹å®‰å…¨, åè€…çº¿ç¨‹ä¸å®‰å…¨.</li>
<li>StringBuilderçš„é€Ÿåº¦æ¯”StringBufferé«˜.</li>
</ul>
]]></content>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
</search>
